"use strict";(self.webpackChunkAngular_Base=self.webpackChunkAngular_Base||[]).push([[682],{3682:(Et,F,s)=>{s.r(F),s.d(F,{TicketModule:()=>qt});var l=s(6814),M=s(6760),p=s(9284),t=s(4946),Z=s(5406);const Q={browse:[{column:"company.fantasy_name",title:"Empresa"},{column:"title",title:"T\xedtulo"},{column:"created_at",title:"Criado"},{column:"requester.name",title:"Solicitante"},{column:"assigned.name",title:"Atribu\xeddo"},{column:"category.description",title:"Categoria"},{column:"priority",title:"Prioridade"}]};let h=(()=>{class i extends Z.m{onCreate(){this.api="ticket",this.columns=Q}static \u0275fac=function(){let e;return function(n){return(e||(e=t.n5z(i)))(n||i)}}();static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var Y=s(2325),w=s(5865),D=s(7297),v=s(1456),B=s(4563);let N=(()=>{class i extends B._{onCreate(){this.api="ticket",this.form=this.formBuilder.group({id:[""],title:[""],description:[""],start_date:[new Date],end_date:[],created_at:[new Date],updated_at:[],client:[],company:[],category:[],priority:[],requester:[],assigned:[],assigned_id:[""],ticket_times:[[]],ticket_observers:[[]],ticket_histories:[[]]})}static \u0275fac=function(){let e;return function(n){return(e||(e=t.n5z(i)))(n||i)}}();static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var a=s(95),y=s(2333),k=s(8368),C=s(7525),q=s(2568),J=s(5261),U=s(420),H=s(8808),E=s(8767);const L=["input"];function G(i,c){if(1&i&&(t.TgZ(0,"span",4),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.errorMessage," ")}}const z=function(i){return{disabled:i}};let T=(()=>{class i extends J.C{minHeight=1;input;editorConfig;ngOnInit(){super.ngOnInit();const e=this.disabled||this.page.disabled;this.editorConfig={editable:!e,spellcheck:!e,height:"auto",minHeight:"20vh",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!e,showToolbar:!e,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["bold","italic"],["fontSize"]]}}onChangeValue(e){this.handleChange(e.target.innerHTML)}static \u0275fac=function(){let e;return function(n){return(e||(e=t.n5z(i)))(n||i)}}();static \u0275cmp=t.Xpm({type:i,selectors:[["rca-textarea"]],viewQuery:function(o,n){if(1&o&&t.Gf(L,5),2&o){let r;t.iGM(r=t.CRH())&&(n.input=r.first)}},inputs:{minHeight:"minHeight"},features:[t._Bn([{provide:a.JU,useExisting:i,multi:!0}]),t.qOj],decls:8,vars:12,consts:[["loading","",1,"control"],[3,"ngClass","ngModel","config","ariaRowSpan","minHeight","ngModelChange","blur"],["input",""],["class","has-text-danger",4,"ngIf"],[1,"has-text-danger"]],template:function(o,n){1&o&&(t._uU(0),t.ALo(1,"pure"),t.TgZ(2,"div",0)(3,"label"),t._uU(4),t.qZA(),t.TgZ(5,"angular-editor",1,2),t.NdJ("ngModelChange",function(m){return n.value=m})("blur",function(m){return n.onChangeValue(m)}),t.qZA(),t.YNc(7,G,2,1,"span",3),t.qZA()),2&o&&(t.hij(" ",t.lcZ(1,8,n.logRender)," "),t.xp6(4),t.Oqu(n.label),t.xp6(1),t.Q6J("ngClass",t.VKq(10,z,n.disabled||n.page.disabled))("ngModel",n.value)("config",n.editorConfig)("ariaRowSpan",100)("minHeight",n.minHeight),t.xp6(2),t.Q6J("ngIf",!n.valid&&n.errorMessage))},dependencies:[l.mk,l.O5,a.JJ,a.On,U.s6,H.T,E.J],encapsulation:2})}return i})();var K=s(6195),j=s(2193),d=s(3209);let I=(()=>{class i extends Z.m{onCreate(){this.api="ticket-history"}static \u0275fac=function(){let e;return function(n){return(e||(e=t.n5z(i)))(n||i)}}();static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var x=s(6619),$=s(1073),P=s(7624);function V(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"h1"),t._uU(2,"Nova observa\xe7\xe3o"),t.qZA(),t.TgZ(3,"form",3),t._UZ(4,"rca-textarea",4)(5,"rca-edit-text",5),t.qZA(),t.TgZ(6,"div",6)(7,"button",7),t.NdJ("click",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.handleOnSubmit(n))}),t._uU(8," Gravar "),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("formGroup",e.formGroup)}}let O=(()=>{class i extends x.y{ticketHistoryService;ticket;onClose=new t.vpe;formGroup;constructor(e,o){super(e),this.ticketHistoryService=o}ngOnInit(){this.formGroup=this.formBuilder.group({ticket:[this.ticket.id],company:[this.ticket.company.id],description:["",[a.kI.required]],time:[0,[a.kI.required]]}),this.pageService.setInitialized()}handleOnSubmit(e){if(!$.Z.validateForm(this.formGroup))return this.alertService.toastDanger({title:"Aten\xe7\xe3o",message:"Verifique os campos obrigat\xf3rios."}),void e.preventDefault();this.ticketHistoryService.insert(this.formGroup.value).subscribe(o=>{this.onClose.emit(!0)})}static \u0275fac=function(o){return new(o||i)(t.Y36(t.zs3),t.Y36(I))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-message-form"]],inputs:{ticket:"ticket"},outputs:{onClose:"onClose"},features:[t._Bn([d.Z]),t.qOj],decls:3,vars:0,consts:[[3,"onClose"],["full",""],[1,"block"],[3,"formGroup"],["formControlName","description","label","Descri\xe7\xe3o",1,"col-12"],["type","number","formControlName","time","label","Tempo",1,"col-12"],[1,"row","flex","align-end","justify-end","mt-2"],[1,"button","is-link","is-left",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"rca-modal",0),t.NdJ("onClose",function(){return n.onClose.emit(!0)}),t.YNc(1,V,9,1,"ng-template",null,1,t.W1O),t.qZA())},dependencies:[C.V,T,a._Y,a.JJ,a.JL,a.sg,a.u,P.z],encapsulation:2})}return i})();function R(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"rca-ticket-message-form",7),t.NdJ("onClose",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.onCloseModalForm(n))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ticket",e.ticket)}}function X(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"div")(3,"span",11)(4,"strong"),t._uU(5),t.qZA()(),t.TgZ(6,"small"),t._uU(7),t.qZA(),t._uU(8," - "),t.TgZ(9,"span"),t._uU(10),t.qZA()(),t.TgZ(11,"ion-icon",12),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.handleClickDelete(r))}),t.qZA()(),t._UZ(12,"div",13),t.qZA()}if(2&i){const e=c.$implicit;t.xp6(5),t.Oqu(e.user.name),t.xp6(2),t.Oqu(e.created_at),t.xp6(3),t.Oqu(e.time),t.xp6(2),t.Q6J("innerHTML",e.description,t.oJD)}}function W(i,c){if(1&i&&(t.ynx(0),t.YNc(1,X,13,4,"div",8),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.items)}}let tt=(()=>{class i{ticketHistoryService;pageService;ticket;onDelete=new t.vpe;items=[];modalTicketMessageVisible=!1;constructor(e,o){this.ticketHistoryService=e,this.pageService=o}ngOnInit(){this.handleLoadData()}handleLoadData(){this.ticketHistoryService.selectMany({ticket_id:this.ticket.id}).subscribe(e=>{this.items=e,this.pageService.setInitialized()})}handleClickDelete(e){this.ticketHistoryService.delete(e.id).subscribe(o=>{this.handleLoadData()})}handleOpenModalForm(){this.modalTicketMessageVisible=!0}onCloseModalForm(e){this.modalTicketMessageVisible=!1,e&&this.handleLoadData()}static \u0275fac=function(o){return new(o||i)(t.Y36(I),t.Y36(d.Z))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-message-list"]],inputs:{ticket:"ticket"},features:[t._Bn([d.Z])],decls:10,vars:2,consts:[[3,"ticket","onClose",4,"ngIf"],[1,"mt-2"],[1,"col-12","flex","justify-content-end"],[1,"button","is-small","is-warning",3,"click"],[1,"icon","is-small"],["name","clipboard-outline"],[4,"ngIf"],[3,"ticket","onClose"],["class","mt-2","style","border: 1px solid #ddd; padding: 5px",4,"ngFor","ngForOf"],[1,"mt-2",2,"border","1px solid #ddd","padding","5px"],[1,"col-12","flex","align-items-center","justify-space-between"],[1,"mr-2"],["name","trash-outline",1,"pointer","p-2",3,"click"],[3,"innerHTML"]],template:function(o,n){1&o&&(t.YNc(0,R,1,1,"rca-ticket-message-form",0),t.TgZ(1,"h2",1),t._uU(2,"Historico de atividades"),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return n.handleOpenModalForm()}),t.TgZ(5,"span"),t._uU(6,"Nova Observa\xe7\xe3o"),t.qZA(),t.TgZ(7,"span",4),t._UZ(8,"ion-icon",5),t.qZA()()(),t.YNc(9,W,2,1,"ng-container",6)),2&o&&(t.Q6J("ngIf",n.modalTicketMessageVisible),t.xp6(9),t.Q6J("ngIf",n.items.length))},dependencies:[l.sg,l.O5,O],encapsulation:2})}return i})();function et(i,c){1&i&&t._UZ(0,"rca-category-browse",18),2&i&&t.Q6J("config",c.$implicit)}function it(i,c){1&i&&t._UZ(0,"rca-category-form",18),2&i&&t.Q6J("config",c.$implicit)}function ot(i,c){1&i&&t._UZ(0,"rca-user-browse",18),2&i&&t.Q6J("config",c.$implicit)}function nt(i,c){1&i&&t._UZ(0,"rca-user-form",18),2&i&&t.Q6J("config",c.$implicit)}function ct(i,c){1&i&&t._UZ(0,"rca-user-browse",18),2&i&&t.Q6J("config",c.$implicit)}function st(i,c){1&i&&t._UZ(0,"rca-user-form",18),2&i&&t.Q6J("config",c.$implicit)}function rt(i,c){if(1&i&&t._UZ(0,"rca-ticket-message-list",19),2&i){const e=t.oxw();t.Q6J("ticket",e.ticketFormService.form.value)}}let g=(()=>{class i{formBuilder;authService;ticketFormService;userService;categoryBrowseService;companyBrowseService;companyFormService;config;constructor(e,o,n,r,m,Ut,Ht){this.formBuilder=e,this.authService=o,this.ticketFormService=n,this.userService=r,this.categoryBrowseService=m,this.companyBrowseService=Ut,this.companyFormService=Ht}static \u0275fac=function(o){return new(o||i)(t.Y36(a.qu),t.Y36(y.e),t.Y36(N),t.Y36(w.K),t.Y36(k.w),t.Y36(v.$),t.Y36(D.Z))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-form"]],inputs:{config:"config"},features:[t._Bn([h,N,w.K,D.Z,v.$])],decls:34,vars:15,consts:[["title","Cadastro de Tickets",3,"config","service","formGroup"],["pageEl",""],[1,"row"],["label","Solicitante","formControlName","requester","colDescription","name",1,"col-9",3,"disable","service"],["elRequester",""],["label","Criado em","formControlName","created_at",1,"col-3",3,"readonly","autofocus"],["label","T\xedtulo","formControlName","title",1,"col-12"],["label","Descri\xe7\xe3o","formControlName","description",1,"col-12",3,"autofocus"],["label","Prioridade","formControlName","priority",1,"col-6"],["label","Categoria","formControlName","category","colDescription","description",1,"col-6",3,"service"],["searchTemplate",""],["formTemplate",""],["label","Atribu\xeddo","formControlName","assigned","colDescription","name",1,"col-8",3,"service"],[1,"col-4"],["label","Data Inicial","formControlName","start_date",1,"col-6",3,"autofocus"],["label","Data Final","formControlName","end_date",1,"col-6",3,"autofocus"],["label","Observadores","formControlName","ticket_observers","colDescription","name",1,"col-12",3,"service","multiple"],[3,"ticket",4,"ngIf"],[3,"config"],[3,"ticket"]],template:function(o,n){1&o&&(t.TgZ(0,"rca-page-form",0,1)(2,"div",2),t._UZ(3,"rca-auto-complete",3,4)(5,"rca-edit-date",5),t.qZA(),t.TgZ(6,"div",2),t._UZ(7,"rca-edit-text",6),t.qZA(),t.TgZ(8,"div",2),t._UZ(9,"rca-textarea",7),t.qZA(),t.TgZ(10,"div",2),t._UZ(11,"rca-edit-text",8),t.TgZ(12,"rca-auto-complete",9),t.YNc(13,et,1,1,"ng-template",null,10,t.W1O),t.YNc(15,it,1,1,"ng-template",null,11,t.W1O),t.qZA()(),t.TgZ(17,"div",2)(18,"rca-auto-complete",12),t.YNc(19,ot,1,1,"ng-template",null,10,t.W1O),t.YNc(21,nt,1,1,"ng-template",null,11,t.W1O),t.qZA(),t.TgZ(23,"div",13)(24,"div",2),t._UZ(25,"rca-edit-date",14)(26,"rca-edit-date",15),t.qZA()()(),t.TgZ(27,"div",2)(28,"rca-auto-complete",16),t.YNc(29,ct,1,1,"ng-template",null,10,t.W1O),t.YNc(31,st,1,1,"ng-template",null,11,t.W1O),t.qZA()(),t.YNc(33,rt,1,1,"rca-ticket-message-list",17),t.qZA()),2&o&&(t.Q6J("config",n.config)("service",n.ticketFormService)("formGroup",n.ticketFormService.form),t.xp6(3),t.Q6J("disable",!0)("service",n.userService),t.xp6(2),t.Q6J("readonly",!0)("autofocus",!0),t.xp6(4),t.Q6J("autofocus",!0),t.xp6(3),t.Q6J("service",n.categoryBrowseService),t.xp6(6),t.Q6J("service",n.userService),t.xp6(7),t.Q6J("autofocus",!0),t.xp6(1),t.Q6J("autofocus",!0),t.xp6(2),t.Q6J("service",n.userService)("multiple",!0),t.xp6(5),t.Q6J("ngIf",n.ticketFormService.form.value.id))},dependencies:[l.O5,C.V,q.F,T,K.j,a.JJ,a.JL,a.sg,a.u,j.i,tt],encapsulation:2})}return i})();function at(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"rca-ticket-message-form",5),t.NdJ("onClose",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.onCloseModalMessage(n))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ticket",e.selectedRow)}}function lt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onClickNewDynamic())}),t.TgZ(1,"span"),t._uU(2,"Novo"),t.qZA(),t.TgZ(3,"span",7),t._UZ(4,"ion-icon",8),t.qZA()()}}function mt(i,c){1&i&&t._UZ(0,"rca-ticket-form",9),2&i&&t.Q6J("config",c.$implicit)}function pt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.handleOpenModalForm(r))}),t.TgZ(1,"span",7),t._UZ(2,"ion-icon",11),t.qZA()()}2&i&&t.Q6J("disabled",c.$implicit.deleted)}let ut=(()=>{class i{route;router;ticketService;config;selectedRow;constructor(e,o,n){this.route=e,this.router=o,this.ticketService=n}onClickNewDynamic(){this.router.navigate(["dynamic"],{relativeTo:this.route})}onCloseModalMessage(e){this.selectedRow=void 0}handleOpenModalForm(e){this.selectedRow=e}static \u0275fac=function(o){return new(o||i)(t.Y36(p.gz),t.Y36(p.F0),t.Y36(h))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-browse"]],inputs:{config:"config"},decls:8,vars:3,consts:[[3,"ticket","onClose",4,"ngIf"],["title","Tickets",3,"service","browseService"],["customActionsTemplate",""],["formTemplate",""],["tableActionsTemplate",""],[3,"ticket","onClose"],[1,"flex-1","ml-1","button","is-small","is-success",2,"background","#ee6634",3,"click"],[1,"icon","is-small"],["name","add"],[3,"config"],[1,"button","is-small","is-link","mh-1",3,"disabled","click"],["name","clipboard-outline"]],template:function(o,n){1&o&&(t.YNc(0,at,1,1,"rca-ticket-message-form",0),t.TgZ(1,"rca-page-browse",1),t.YNc(2,lt,5,0,"ng-template",null,2,t.W1O),t.YNc(4,mt,1,1,"ng-template",null,3,t.W1O),t.YNc(6,pt,3,1,"ng-template",null,4,t.W1O),t.qZA()),2&o&&(t.Q6J("ngIf",n.selectedRow),t.xp6(1),t.Q6J("service",n.ticketService)("browseService",n.ticketService))},dependencies:[l.O5,Y.P,g,O],encapsulation:2})}return i})();var dt=s(5619),f=s(553);const S={step:0,stepCategory:0,stepLast:0,nextStepVisible:!1,previousStepVisible:!1,countCompanies:0};let u=(()=>{class i{fb;ticketService;authService;state;form;activeCategory;companies=[];subscriptions=[];get value(){return this.state.value}get step(){return this.value.step}get categories(){return this.form.get("categories")?.value}get company(){return this.form.get("company")?.value}get stepCategory(){return this.value.stepCategory}get formCategories(){return this.form.get("categories")}get formCategory(){return this.formCategories.controls[this.stepCategory]}constructor(e,o,n){this.fb=e,this.ticketService=o,this.authService=n,this.state=new dt.X(S),this.form=this.fb.group({company:[],title:[""],description:[""],start_date:[new Date],end_date:[""],created_at:[new Date],updated_at:[""],category:[""],priority:[""],requester:[this.authService.user],assigned:[""],assigned_id:[""],ticket_times:[[]],ticket_observers:[[]],categories:this.fb.array([])}),this.subscriptions.push(this.authService.state.subscribe(r=>{const m={...S};this.setState(m)}))}ngOnInit(){}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}newCategory(e=0){const o=this.formCategory?.get("id")?.value||"";this.formCategories.controls[this.stepCategory+e]||(this.activeCategory=this.fb.group({id:[],description:[],sob_category_id:[o],sob_categories:[],sub_categories:[]}),this.formCategories.push(this.activeCategory))}setState(e){const o={...e,stepLast:e.stepLast<e.step?e.step:e.stepLast,previousStepVisible:this.previousStepVisible(e),nextStepVisible:this.nextStepVisible(e)};return this.state.next(o),this}setStep(e,o){return this.setState({...this.value,step:e,stepCategory:o})}setCompanies(e){return this.companies=e,this}setCompany(e){return this.form.patchValue({company:e}),this}setCategory(e){return this.formCategory&&this.formCategory.patchValue(e),this}previousStep(){const e={...this.value};1==this.step?(this.formCategory.value.id||this.formCategories.removeAt(this.stepCategory),this.stepCategory>0?e.stepCategory--:e.step--):2==this.step&&e.step--,this.setState(e)}previousStepVisible(e){return 1==e.step?0!=e.stepCategory||this.companies.length>0:e.step>0}nextStep(){const e={...this.value};0==this.step?(this.newCategory(),e.step++):1==this.step&&this.formCategory&&(this.formCategory?.value?.sub_categories?.length?(this.newCategory(1),e.stepCategory++):e.step++),this.setState(e)}nextStepVisible(e){if(this.categories.length)switch(e.step){case 0:return!f.N.nextOnSelect||!!this.categories[0]?.id;case 1:return e.stepCategory<this.categories.length-1||!!this.categories[e.stepCategory].id;default:return f.N.nextOnSelect&&e.step<2}return!1}save(){return this.ticketService.save({...this.form.value,category:this.formCategory.value})}removeNext(e=!1){const o=0==this.step?0:this.stepCategory+(e?0:1);for(let n=this.formCategories.length-1;n>=o;n--)this.formCategories.removeAt(n)}static \u0275fac=function(o){return new(o||i)(t.LFG(a.qu),t.LFG(h),t.LFG(y.e))};static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac})}return i})();var _=s(8180);const gt=function(i){return{selected:i}};let A=(()=>{class i extends J.C{title="";selected=!1;static \u0275fac=function(){let e;return function(n){return(e||(e=t.n5z(i)))(n||i)}}();static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-card"]],inputs:{title:"title",selected:"selected"},features:[t._Bn([d.Z,{provide:a.JU,useExisting:i,multi:!0}]),t.qOj],decls:3,vars:4,consts:[[1,"box","p-5","m-2",3,"ngClass"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"p"),t._uU(2),t.qZA()()),2&o&&(t.Q6J("ngClass",t.VKq(2,gt,n.selected)),t.xp6(2),t.Oqu(n.title))},dependencies:[l.mk],styles:["[_nghost-%COMP%]{display:grid;font-size:1.5rem;text-align:center}[_nghost-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#6091ed!important;color:#fff}[_nghost-%COMP%]:hover{cursor:pointer}"]})}return i})();function ft(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.handlePreviousStep())}),t.TgZ(1,"span",5),t._UZ(2,"ion-icon",6),t.qZA()()}}function _t(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.handleNextStep())}),t.TgZ(1,"span",5),t._UZ(2,"ion-icon",7),t.qZA()()}}let b=(()=>{class i{ticketDynamicFormService;onClose=new t.vpe;ticketState;subscriptions=[];constructor(e){this.ticketDynamicFormService=e}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe(e=>{this.ticketState=e}))}handlePreviousStep(){this.ticketDynamicFormService.previousStep()}handleNextStep(){this.ticketDynamicFormService.nextStep()}handleSubmit(){this.ticketDynamicFormService.save(),this.onClose.observed&&this.onClose.emit()}static \u0275fac=function(o){return new(o||i)(t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-buttons"]],outputs:{onClose:"onClose"},decls:5,vars:2,consts:[[1,"row","align-center","justify-center","mt-4"],[1,"col-1"],[1,"row"],["class","col-6 button is-small is-info",3,"click",4,"ngIf"],[1,"col-6","button","is-small","is-info",3,"click"],[1,"icon","is-small"],["name","chevron-back-outline"],["name","chevron-forward-outline"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,ft,3,0,"button",3),t.YNc(4,_t,3,0,"button",3),t.qZA()()()),2&o&&(t.xp6(3),t.Q6J("ngIf",n.ticketState.previousStepVisible),t.xp6(1),t.Q6J("ngIf",n.ticketState.nextStepVisible))},dependencies:[l.O5],encapsulation:2})}return i})();function ht(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"rca-ticket-dynamic-form-card",4),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.handleSelectItem(r))}),t.qZA(),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw();t.xp6(1),t.Q6J("title",e.description)("selected",o.selectedItem&&o.selectedItem.id==e.id)}}let vt=(()=>{class i extends x.y{categoryBrowseService;ticketDynamicFormService;onSelectItem=new t.vpe;items=[];selectedItem;constructor(e,o,n){super(e),this.categoryBrowseService=o,this.ticketDynamicFormService=n}ngOnInit(){this.initialLoad()}initialLoad(){const o=this.ticketDynamicFormService.formCategory.value;o.sob_category_id?o.sob_category_id&&this.loadSubCategories(o.sob_category_id):this.loadCategories()}loadCategories(e){this.subscriptions.push(this.categoryBrowseService.getCategories((e||this.ticketDynamicFormService.company).id).pipe((0,_.q)(1)).subscribe(n=>{n.length>0?this.items=n:(this.alertService.toastInfo({title:"Aten\xe7\xe3o",message:"N\xe3o existem categorias cadastradas para essa empresa."}),this.router.navigate(["../"],{relativeTo:this.route}))}))}loadSubCategories(e){this.subscriptions.push(this.categoryBrowseService.getSubCategories(e).pipe((0,_.q)(1)).subscribe(o=>{this.items=o}))}loadSobCategories(e){this.subscriptions.push(this.categoryBrowseService.getSobCategories(e).pipe((0,_.q)(1)).subscribe(o=>{this.items=o}))}handleSelectItem(e){this.selectedItem?.id!=e.id&&(this.selectedItem=e,this.ticketDynamicFormService.removeNext()),f.N.nextOnSelect&&this.handleClickNext()}handleClickNext(){this.selectedItem&&this.ticketDynamicFormService.setCategory(this.selectedItem).nextStep()}handleClickPrevious(){this.ticketDynamicFormService.previousStep()}static \u0275fac=function(o){return new(o||i)(t.Y36(t.zs3),t.Y36(k.w),t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-category"]],outputs:{onSelectItem:"onSelectItem"},features:[t.qOj],decls:4,vars:1,consts:[[1,"row"],[1,"col-12","m-3",3,"onNext","onPrevious"],[1,"col-12","flex-column","justify-center","align-center"],[4,"ngFor","ngForOf"],[1,"col-3",3,"title","selected","click"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"rca-ticket-dynamic-form-buttons",1),t.NdJ("onNext",function(){return n.handleClickNext()})("onPrevious",function(){return n.handleClickPrevious()}),t.qZA()(),t.TgZ(2,"div",2),t.YNc(3,ht,2,2,"ng-container",3),t.qZA()),2&o&&(t.xp6(3),t.Q6J("ngForOf",n.items))},dependencies:[l.sg,A,b],encapsulation:2})}return i})();const yt=function(i){return{selected:i}};function kt(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"rca-ticket-dynamic-form-card",7),t.NdJ("click",function(){const r=t.CHM(e).$implicit,m=t.oxw(3);return t.KtG(m.handleSelectItem(r))}),t.qZA(),t.BQk()}if(2&i){const e=c.$implicit,o=t.oxw(3);t.xp6(1),t.Q6J("title",e.fantasy_name)("selected",(null==o.selectedItem?null:o.selectedItem.id)==(null==e?null:e.id))("ngClass",t.VKq(3,yt,(null==o.selectedItem?null:o.selectedItem.id)==(null==e?null:e.id)))}}function Ct(i,c){if(1&i&&(t.ynx(0),t.YNc(1,kt,2,5,"ng-container",6),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.items)}}function Tt(i,c){if(1&i&&(t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"rca-ticket-dynamic-form-buttons",3),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,Ct,2,1,"ng-container",5),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("hidden",e.ticketState.step>0),t.xp6(3),t.Q6J("ngIf",e.items)}}let xt=(()=>{class i{router;route;companyBrowseService;ticketDynamicFormService;authService;items=[];selectedItem;ticketState=S;subscriptions=[];constructor(e,o,n,r,m){this.router=e,this.route=o,this.companyBrowseService=n,this.ticketDynamicFormService=r,this.authService=m}ngOnInit(){this.ticketDynamicFormService.state.subscribe(e=>{this.ticketState=e}),this.subscriptions.push(this.authService.state.subscribe(e=>{this.handleLoadData()}))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}handleLoadData(){this.companyBrowseService.selectMany().pipe((0,_.q)(1)).subscribe(e=>{e.length>1?(this.selectedItem=void 0,this.items=e):1==e.length?(this.items=e,this.handleSelectItem(e[0])):this.router.navigate(["../"],{relativeTo:this.route})})}handleSelectItem(e){e&&(this.selectedItem&&this.selectedItem.id!=e.id&&this.ticketDynamicFormService.removeNext(),this.selectedItem=e),f.N.nextOnSelect&&this.handleClickNext()}handleClickNext(){this.selectedItem&&this.ticketDynamicFormService.setCompanies(this.items).setCompany(this.selectedItem).nextStep()}handleClickPrevious(){this.ticketDynamicFormService.previousStep()}static \u0275fac=function(o){return new(o||i)(t.Y36(p.F0),t.Y36(p.gz),t.Y36(v.$),t.Y36(u),t.Y36(y.e))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-company"]],decls:1,vars:1,consts:[["class","row justify-center",4,"ngIf"],[1,"row","justify-center"],[1,"row",3,"hidden"],[1,"col-12","m-3"],[1,"col-4"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-12","p-3",3,"title","selected","ngClass","click"]],template:function(o,n){1&o&&t.YNc(0,Tt,5,2,"div",0),2&o&&t.Q6J("ngIf",0==n.ticketState.step)},dependencies:[l.mk,l.sg,l.O5,A,b],encapsulation:2})}return i})();function St(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"li",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.handleChangeStep(0,0))}),t.TgZ(1,"a"),t._uU(2),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.company.fantasy_name)}}const bt=function(i){return{"is-active":i}};function Ft(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"li",6),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,r=t.oxw(2);return t.KtG(r.handleChangeStep(1,n))}),t.TgZ(1,"a"),t._uU(2),t.qZA()()}if(2&i){const e=t.oxw(),n=e.$implicit;t.Q6J("ngClass",t.VKq(2,bt,e.last)),t.xp6(2),t.Oqu(n.description)}}function Zt(i,c){if(1&i&&(t.ynx(0),t.YNc(1,Ft,3,4,"li",5),t.BQk()),2&i){const e=c.index,o=c.last,n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",n.ticketState.stepCategory>e||n.ticketState.step>1&&o)}}function wt(i,c){if(1&i&&(t.TgZ(0,"ul"),t.YNc(1,St,3,1,"li",2),t.YNc(2,Zt,2,1,"ng-container",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.ticketState.step>0),t.xp6(1),t.Q6J("ngForOf",e.categories)}}let Dt=(()=>{class i{ticketDynamicFormService;onClose=new t.vpe;ticketState;subscriptions=[];get company(){return this.ticketDynamicFormService.company}get categories(){return this.ticketDynamicFormService.formCategories.value}constructor(e){this.ticketDynamicFormService=e}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe(e=>{this.ticketState=e}))}handleChangeStep(e,o){this.ticketDynamicFormService.setStep(e,o)}static \u0275fac=function(o){return new(o||i)(t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-header"]],outputs:{onClose:"onClose"},decls:4,vars:1,consts:[["aria-label","breadcrumbs",1,"breadcrumb"],[4,"ngIf"],[3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"],[3,"ngClass","click",4,"ngIf"],[3,"ngClass","click"]],template:function(o,n){1&o&&(t.TgZ(0,"h1"),t._uU(1,"Novo Ticket"),t.qZA(),t.TgZ(2,"nav",0),t.YNc(3,wt,3,2,"ul",1),t.qZA()),2&o&&(t.xp6(3),t.Q6J("ngIf",n.company))},dependencies:[l.mk,l.sg,l.O5],encapsulation:2})}return i})();function Nt(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"rca-ticket-dynamic-form-category",8),t.BQk()),2&i){const e=c.index,o=t.oxw(3);t.xp6(1),t.Q6J("hidden",1!=o.ticketState.step||o.ticketState.stepCategory!=e)}}function Jt(i,c){if(1&i&&(t.ynx(0),t.YNc(1,Nt,2,1,"ng-container",7),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",null==e.formCategories?null:e.formCategories.controls)}}function It(i,c){1&i&&(t.ynx(0),t.TgZ(1,"div",5),t._UZ(2,"rca-ticket-dynamic-form-buttons",9),t.qZA(),t.TgZ(3,"div",5),t._UZ(4,"rca-edit-text",10)(5,"rca-textarea",11),t.qZA(),t.BQk()),2&i&&(t.xp6(5),t.Q6J("minHeight",200))}function Ot(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.handleSubmit())}),t.TgZ(1,"span",13),t._UZ(2,"ion-icon",14),t.qZA()()}}function At(i,c){if(1&i&&(t.TgZ(0,"form",1),t._UZ(1,"rca-ticket-dynamic-form-company"),t.YNc(2,Jt,2,1,"ng-container",2),t.YNc(3,It,6,1,"ng-container",2),t.ynx(4),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5),t.YNc(8,Ot,3,0,"button",6),t.qZA()()(),t.BQk(),t.qZA()),2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("ngIf",e.formCategories),t.xp6(1),t.Q6J("ngIf",2==e.ticketState.step),t.xp6(5),t.Q6J("ngIf",2==e.ticketState.step)}}let Mt=(()=>{class i extends x.y{ticketDynamicFormService;ticketState;get form(){return this.ticketDynamicFormService.form}get formCategories(){return this.ticketDynamicFormService.formCategories}constructor(e,o){super(e),this.ticketDynamicFormService=o}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe({next:e=>{this.ticketState=e}})),this.pageService.setInitialized()}handleSubmit(){this.ticketDynamicFormService.save().subscribe(e=>{this.navigateToBrowse()})}navigateToBrowse=()=>{this.form.reset(),this.router.navigate([".."],{relativeTo:this.route})};static \u0275fac=function(o){return new(o||i)(t.Y36(t.zs3),t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form"]],features:[t._Bn([d.Z,u,k.w]),t.qOj],decls:2,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngIf"],[1,"row","align-center","justify-center","mt-4"],[1,"col-1"],[1,"row"],["class","col-6 button is-small is-info",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"hidden"],[1,"col-12","m-3"],["label","Assunto","formControlName","title",1,"col-12"],["label","Descri\xe7\xe3o","formControlName","description",1,"col-12",3,"minHeight"],[1,"col-6","button","is-small","is-info",3,"click"],[1,"icon","is-medium"],["name","save"]],template:function(o,n){1&o&&(t._UZ(0,"rca-ticket-dynamic-form-header"),t.YNc(1,At,9,4,"form",0)),2&o&&(t.xp6(1),t.Q6J("ngIf",n.form))},dependencies:[l.sg,l.O5,C.V,T,a._Y,a.JJ,a.JL,a.sg,a.u,vt,xt,b,Dt],encapsulation:2})}return i})();var Qt=s(5583);const Yt=[{path:"",component:ut,pathMatch:"full"},{path:"dynamic",component:Mt,pathMatch:"full"},{path:"new",component:g,pathMatch:"full"},{path:":id/view",component:g,pathMatch:"full"},{path:":id/edit",component:g,pathMatch:"full"},{path:":id/delete",component:g,pathMatch:"full"}];let Bt=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=t.oAB({type:i});static \u0275inj=t.cJS({imports:[a.u5,a.UX,Qt.D,p.Bz.forChild(Yt),p.Bz]})}return i})(),qt=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=t.oAB({type:i});static \u0275inj=t.cJS({imports:[l.ez,M.m,Bt]})}return i})()}}]);