"use strict";(self.webpackChunkAngular_Base=self.webpackChunkAngular_Base||[]).push([[809],{1809:(He,Z,r)=>{r.r(Z),r.d(Z,{TicketRoutingModule:()=>Be});var g=r(9284),D=r(2325),e=r(4946),w=r(5406);const H={browse:[{column:"company.fantasy_name",title:"Empresa"},{column:"title",title:"T\xedtulo"},{column:"created_at",title:"Criado"},{column:"requester.name",title:"Solicitante"},{column:"assigned.name",title:"Atribu\xeddo"},{column:"category.description",title:"Categoria"},{column:"priority",title:"Prioridade"}]};let v=(()=>{class i extends w.m{onCreate(){this.api="ticket",this.columns=H}static \u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(i)))(n||i)}}();static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var q=r(9972),h=r(2447),J=r(7396),M=r(7297),C=r(3183),N=r(4563),u=r(6676);let I=(()=>{class i extends N._{onCreate(){this.api="ticket",this.form=this.formBuilder.group({id:[""],title:[""],description:[""],start_date:[u(new Date).format("yyyy-MM-DD")],end_date:[],created_at:[u(new Date).format("yyyy-MM-DD")],updated_at:[],client:[],company:[],category:[],priority:[],requester:[],assigned:[],assigned_id:[""],ticket_times:[[]],ticket_observers:[[]],ticket_histories:[[]]})}convertData(t){return{...t,created_at:u(t.updated_at).format("yyyy-MM-DD"),updated_at:u(t.updated_at).format("yyyy-MM-DD"),start_date:u(t.updated_at).format("yyyy-MM-DD"),end_date:u(t.updated_at).format("yyyy-MM-DD")}}static \u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(i)))(n||i)}}();static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var d=r(2193),k=r(7144),l=r(6814),T=r(7525),E=r(2568),a=r(95),Q=r(5261),L=r(420),U=r(8808),z=r(8767);const G=["input"];function P(i,s){if(1&i&&(e.TgZ(0,"span",4),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.errorMessage," ")}}let x=(()=>{class i extends Q.C{minHeight=1;input;editorConfig;ngOnInit(){super.ngOnInit(),this.editorConfig={editable:!this.disable||this.owner?.disable,spellcheck:!this.disable||this.owner?.disable,height:"auto",minHeight:"20vh",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!(this.disable||this.owner?.disable),showToolbar:!(this.disable||this.owner?.disable),placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["bold","italic"],["fontSize"]]}}onChangeValue(t){this.handleChange(this.value)}static \u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(i)))(n||i)}}();static \u0275cmp=e.Xpm({type:i,selectors:[["rca-textarea"]],viewQuery:function(o,n){if(1&o&&e.Gf(G,5),2&o){let c;e.iGM(c=e.CRH())&&(n.input=c.first)}},inputs:{minHeight:"minHeight"},features:[e._Bn([{provide:a.JU,useExisting:i,multi:!0}]),e.qOj],decls:8,vars:11,consts:[["loading","",1,"control"],[3,"id","name","ngModel","config","ariaRowSpan","minHeight","ngModelChange","blur"],["input",""],["class","has-text-danger",4,"ngIf"],[1,"has-text-danger"]],template:function(o,n){1&o&&(e._uU(0),e.ALo(1,"pure"),e.TgZ(2,"div",0)(3,"label"),e._uU(4),e.qZA(),e.TgZ(5,"angular-editor",1,2),e.NdJ("ngModelChange",function(m){return n.value=m})("blur",function(){return n.onChangeValue(n.value)}),e.qZA(),e.YNc(7,P,2,1,"span",3),e.qZA()),2&o&&(e.hij("",e.lcZ(1,9,n.logRender)," "),e.xp6(4),e.Oqu(n.label),e.xp6(1),e.Q6J("id",n.elementId)("name",n.elementId)("ngModel",n.value)("config",n.editorConfig)("ariaRowSpan",100)("minHeight",n.minHeight),e.xp6(2),e.Q6J("ngIf",!n.valid&&n.errorMessage))},dependencies:[l.O5,a.JJ,a.On,L.s6,U.T,z.J],encapsulation:2})}return i})();var j=r(6195),K=r(6406),R=r(2232),V=r(2331),X=r(341);let A=(()=>{class i extends N._{onCreate(){this.api="ticket-history",this.form=this.formBuilder.group({ticket:[""],company:[""],description:["",[a.kI.required]],time:[0,[a.kI.required]]})}static \u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(i)))(n||i)}}();static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();function $(i,s){1&i&&e._UZ(0,"rca-textarea",2)(1,"rca-edit-text",3)}let S=(()=>{class i extends d.i{ticketMessageFormService;formEl;constructor(t,o){super(t),this.ticketMessageFormService=o}open(t){this.formEl.open({action:"new",initialValue:{ticket:t.id}})}static \u0275fac=function(o){return new(o||i)(e.Y36(e.zs3),e.Y36(A))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-message-form"]],viewQuery:function(o,n){if(1&o&&e.Gf(d.i,5),2&o){let c;e.iGM(c=e.CRH())&&(n.formEl=c.first)}},features:[e._Bn([A]),e.qOj],decls:3,vars:3,consts:[["title","Nova Observa\xe7\xe3o",3,"modal","service","formGroup","onClose"],["body",""],["formControlName","description","label","Descri\xe7\xe3o",1,"col-12"],["type","number","formControlName","time","label","Tempo",1,"col-12"]],template:function(o,n){1&o&&(e.TgZ(0,"rca-page-form",0),e.NdJ("onClose",function(m){return n.onClose.emit(m)}),e.YNc(1,$,2,0,"ng-template",null,1,e.W1O),e.qZA()),2&o&&e.Q6J("modal",n.modal)("service",n.ticketMessageFormService)("formGroup",n.ticketMessageFormService.form)},dependencies:[T.V,x,a.JJ,a.JL,a.sg,a.u,d.i],encapsulation:2})}return i})(),W=(()=>{class i extends w.m{onCreate(){this.api="ticket-history"}static \u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(i)))(n||i)}}();static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();function ee(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"div")(3,"span",9)(4,"strong"),e._uU(5),e.qZA()(),e.TgZ(6,"small"),e._uU(7),e.qZA(),e._uU(8," - "),e.TgZ(9,"span"),e._uU(10),e.qZA()(),e.TgZ(11,"ion-icon",10),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(2);return e.KtG(m.handleClickDelete(c))}),e.qZA()(),e._UZ(12,"div",11),e.qZA()}if(2&i){const t=s.$implicit;e.xp6(5),e.Oqu(t.user.name),e.xp6(2),e.Oqu(t.created_at),e.xp6(3),e.Oqu(t.time),e.xp6(2),e.Q6J("innerHTML",t.description,e.oJD)}}function te(i,s){if(1&i&&(e.ynx(0),e.YNc(1,ee,13,4,"div",6),e.BQk()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.items)}}let ie=(()=>{class i{ticketHistoryService;ticket;formEl;onDelete=new e.vpe;items=[];modalTicketMessageVisible=!1;constructor(t){this.ticketHistoryService=t}ngOnInit(){this.handleLoadData()}handleLoadData(){this.ticketHistoryService.selectMany({ticket_id:this.ticket.id}).subscribe(t=>{this.items=t})}handleClickDelete(t){this.ticketHistoryService.delete(t.id).subscribe(o=>{this.handleLoadData()})}handleOpenModalForm(){this.formEl.open(this.ticket)}static \u0275fac=function(o){return new(o||i)(e.Y36(W))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-message-list"]],viewQuery:function(o,n){if(1&o&&e.Gf(S,5),2&o){let c;e.iGM(c=e.CRH())&&(n.formEl=c.first)}},inputs:{ticket:"ticket"},features:[e._Bn([])],decls:7,vars:2,consts:[[3,"modal","onClose"],["formMessage",""],[1,"row","mt-2"],[1,"col-9"],["type","info","iconLeft","clipboard-outline","label","Nova Observa\xe7\xe3o",1,"col-3",3,"onClick"],[4,"ngIf"],["class","mt-2","style","border: 1px solid #ddd; padding: 5px",4,"ngFor","ngForOf"],[1,"mt-2",2,"border","1px solid #ddd","padding","5px"],[1,"col-12","flex","align-items-center","justify-space-between"],[1,"mr-2"],["name","trash-outline",1,"pointer","p-2",2,"color","red",3,"click"],[3,"innerHTML"]],template:function(o,n){1&o&&(e.TgZ(0,"rca-ticket-message-form",0,1),e.NdJ("onClose",function(){return n.handleLoadData()}),e.qZA(),e.TgZ(2,"div",2)(3,"h2",3),e._uU(4,"Historico de atividades"),e.qZA(),e.TgZ(5,"rca-button",4),e.NdJ("onClick",function(){return n.handleOpenModalForm()}),e.qZA()(),e.YNc(6,te,2,1,"ng-container",5)),2&o&&(e.Q6J("modal",!0),e.xp6(6),e.Q6J("ngIf",n.items.length))},dependencies:[l.sg,l.O5,h.m,S],encapsulation:2})}return i})();function oe(i,s){if(1&i&&e._UZ(0,"rca-ticket-message-list",19),2&i){const t=e.oxw(2);e.Q6J("ticket",t.ticketFormService.form.value)}}function ne(i,s){if(1&i&&(e.TgZ(0,"div",2),e._UZ(1,"rca-auto-complete",3,4)(3,"rca-edit-date",5),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"rca-edit-text",6),e.qZA(),e.TgZ(6,"div",2),e._UZ(7,"rca-textarea",7),e.qZA(),e.TgZ(8,"div",2),e._UZ(9,"rca-edit-text",8),e.TgZ(10,"rca-auto-complete",9),e._UZ(11,"rca-category-browse",10,11)(13,"rca-category-form",10,12),e.qZA()(),e.TgZ(15,"div",2)(16,"rca-auto-complete",13),e._UZ(17,"rca-user-browse",10,11)(19,"rca-user-form",10,12),e.qZA(),e.TgZ(21,"div",14)(22,"div",2),e._UZ(23,"rca-edit-date",15)(24,"rca-edit-date",16),e.qZA()()(),e.TgZ(25,"div",2)(26,"rca-auto-complete",17),e._UZ(27,"rca-user-browse",10,11)(29,"rca-user-form",10,12),e.qZA()(),e.YNc(31,oe,1,1,"rca-ticket-message-list",18)),2&i){const t=e.oxw();e.xp6(1),e.Q6J("service",t.userService),e.xp6(6),e.Q6J("autofocus",!0),e.xp6(3),e.Q6J("service",t.categoryBrowseService),e.xp6(1),e.Q6J("modal",!0),e.xp6(2),e.Q6J("modal",!0),e.xp6(3),e.Q6J("service",t.userService),e.xp6(1),e.Q6J("modal",!0),e.xp6(2),e.Q6J("modal",!0),e.xp6(4),e.Q6J("autofocus",!0),e.xp6(1),e.Q6J("autofocus",!0),e.xp6(2),e.Q6J("service",t.userService)("multiple",!0),e.xp6(1),e.Q6J("modal",!0),e.xp6(2),e.Q6J("modal",!0),e.xp6(2),e.Q6J("ngIf",t.ticketFormService.initialized&&"new"!=t.ticketFormService.action)}}let f=(()=>{class i extends d.i{ticketFormService;userService;categoryBrowseService;companyBrowseService;companyFormService;constructor(t,o,n,c,m,Ye){super(t),this.ticketFormService=o,this.userService=n,this.categoryBrowseService=c,this.companyBrowseService=m,this.companyFormService=Ye}static \u0275fac=function(o){return new(o||i)(e.Y36(e.zs3),e.Y36(I),e.Y36(J.K),e.Y36(k.w),e.Y36(C.$),e.Y36(M.Z))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-form"]],features:[e._Bn([v,I,J.K,M.Z,C.$]),e.qOj],decls:3,vars:4,consts:[["title","Cadastro de Tickets",3,"modal","size","service","formGroup"],["body",""],[1,"row"],["label","Solicitante","colDescription","name","formControlName","requester",1,"col-9",3,"service"],["elRequester",""],["label","Criado em","formControlName","created_at",1,"col-3"],["label","T\xedtulo","formControlName","title",1,"col-12"],["label","Descri\xe7\xe3o","formControlName","description",1,"col-12",3,"autofocus"],["label","Prioridade","formControlName","priority",1,"col-6"],["label","Categoria","formControlName","category","colDescription","description",1,"col-6",3,"service"],[3,"modal"],["browse",""],["form",""],["label","Atribu\xeddo","formControlName","assigned","colDescription","name",1,"col-8",3,"service"],[1,"col-4"],["label","Data Inicial","formControlName","start_date",1,"col-6",3,"autofocus"],["label","Data Final","formControlName","end_date",1,"col-6",3,"autofocus"],["label","Observadores","formControlName","ticket_observers","colDescription","name",1,"col-12",3,"service","multiple"],[3,"ticket",4,"ngIf"],[3,"ticket"]],template:function(o,n){1&o&&(e.TgZ(0,"rca-page-form",0),e.YNc(1,ne,32,15,"ng-template",null,1,e.W1O),e.qZA()),2&o&&e.Q6J("modal",n.modal)("size",n.size)("service",n.ticketFormService)("formGroup",n.ticketFormService.form)},dependencies:[l.O5,T.V,E.F,x,j.j,a.JJ,a.JL,a.sg,a.u,d.i,K.M,R.C,V.e,X.m,ie],encapsulation:2})}return i})();const re=["formMessage"];function ce(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"rca-button",7),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onClickNewDynamic())}),e.qZA()}}function se(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"rca-button",8),e.NdJ("onClick",function(){const c=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.handleOpenFormMessage(c))}),e.qZA()}}let ae=(()=>{class i extends D.P{ticketService;formMessageEl;constructor(t,o){super(t),this.ticketService=o}onClickNewDynamic(){this.router.navigate(["dynamic"],{relativeTo:this.route})}handleOpenFormMessage(t){this.formMessageEl.open(t)}static \u0275fac=function(o){return new(o||i)(e.Y36(e.zs3),e.Y36(v))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-browse"]],viewQuery:function(o,n){if(1&o&&e.Gf(re,5),2&o){let c;e.iGM(c=e.CRH())&&(n.formMessageEl=c.first)}},features:[e.qOj],decls:9,vars:4,consts:[[3,"modal"],["formMessage",""],["title","Tickets",3,"modal","service"],["size","large",3,"modal"],["form",""],["customActions",""],["tableActions",""],["type","info","iconLeft","add","label","Novo",3,"onClick"],["small","","type","success","icon","clipboard-outline",3,"onClick"]],template:function(o,n){1&o&&(e._UZ(0,"rca-ticket-message-form",0,1),e.TgZ(2,"rca-page-browse",2),e._UZ(3,"rca-ticket-form",3,4),e.YNc(5,ce,1,0,"ng-template",null,5,e.W1O),e.YNc(7,se,1,0,"ng-template",null,6,e.W1O),e.qZA()),2&o&&(e.Q6J("modal",!0),e.xp6(2),e.Q6J("modal",n.modal)("service",n.ticketService),e.xp6(1),e.Q6J("modal",!0))},dependencies:[q.D,h.m,D.P,f,S],encapsulation:2})}return i})();var me=r(5619),y=r(553),O=r(2333);const b={step:0,stepCategory:0,stepLast:0,nextStepVisible:!1,previousStepVisible:!1,countCompanies:0};let p=(()=>{class i{fb;ticketService;authService;state;form;activeCategory;companies=[];subscriptions=[];get value(){return this.state.value}get step(){return this.value.step}get categories(){return this.form.get("categories")?.value}get company(){return this.form.get("company")?.value}get stepCategory(){return this.value.stepCategory}get formCategories(){return this.form.get("categories")}get formCategory(){return this.formCategories.controls[this.stepCategory]}constructor(t,o,n){this.fb=t,this.ticketService=o,this.authService=n,this.state=new me.X(b),this.form=this.fb.group({company:[],title:[""],description:[""],start_date:[new Date],end_date:[""],created_at:[new Date],updated_at:[""],category:[""],priority:[""],requester:[this.authService.user],assigned:[""],assigned_id:[""],ticket_times:[[]],ticket_observers:[[]],categories:this.fb.array([])}),this.subscriptions.push(this.authService.state.subscribe(c=>{const m={...b};this.setState(m)}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}newCategory(t=0){const o=this.formCategory?.get("id")?.value||"";this.formCategories.controls[this.stepCategory+t]||(this.activeCategory=this.fb.group({id:[],description:[],sob_category_id:[o],sob_categories:[],sub_categories:[]}),this.formCategories.push(this.activeCategory))}setState(t){const o={...t,stepLast:t.stepLast<t.step?t.step:t.stepLast,previousStepVisible:this.previousStepVisible(t),nextStepVisible:this.nextStepVisible(t)};return this.state.next(o),this}setStep(t,o){return this.setState({...this.value,step:t,stepCategory:o})}setCompanies(t){return this.companies=t,this}setCompany(t){return this.form.patchValue({company:t}),this}setCategory(t){return this.formCategory&&this.formCategory.patchValue(t),this}previousStep(){const t={...this.value};1==this.step?(this.formCategory.value.id||this.formCategories.removeAt(this.stepCategory),this.stepCategory>0?t.stepCategory--:t.step--):2==this.step&&t.step--,this.setState(t)}previousStepVisible(t){return 1==t.step?0!=t.stepCategory||this.companies.length>0:t.step>0}nextStep(){const t={...this.value};0==this.step?(this.newCategory(),t.step++):1==this.step&&this.formCategory&&(this.formCategory?.value?.sub_categories?.length?(this.newCategory(1),t.stepCategory++):t.step++),this.setState(t)}nextStepVisible(t){if(this.categories.length)switch(t.step){case 0:return!y.N.nextOnSelect||!!this.categories[0]?.id;case 1:return t.stepCategory<this.categories.length-1||!!this.categories[t.stepCategory].id;default:return y.N.nextOnSelect&&t.step<2}return!1}save(){return this.ticketService.save({...this.form.value,category:this.formCategory.value})}removeNext(t=!1){const o=0==this.step?0:this.stepCategory+(t?0:1);for(let n=this.formCategories.length-1;n>=o;n--)this.formCategories.removeAt(n)}static \u0275fac=function(o){return new(o||i)(e.LFG(a.qu),e.LFG(v),e.LFG(O.e))};static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac})}return i})();var B=r(6619),_=r(8180);const le=function(i){return{selected:i}};let Y=(()=>{class i extends Q.C{title="";selected=!1;static \u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(i)))(n||i)}}();static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-card"]],inputs:{title:"title",selected:"selected"},features:[e._Bn([{provide:a.JU,useExisting:i,multi:!0}]),e.qOj],decls:3,vars:4,consts:[[1,"box","p-5","m-2",3,"ngClass"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"p"),e._uU(2),e.qZA()()),2&o&&(e.Q6J("ngClass",e.VKq(2,le,n.selected)),e.xp6(2),e.Oqu(n.title))},dependencies:[l.mk],styles:["[_nghost-%COMP%]{display:grid;font-size:1.5rem;text-align:center}[_nghost-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#6091ed!important;color:#fff}[_nghost-%COMP%]:hover{cursor:pointer}"]})}return i})();function ue(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"rca-button",5),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.handlePreviousStep())}),e.qZA()}}function pe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"rca-button",6),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.handleNextStep())}),e.qZA()}}let F=(()=>{class i{ticketDynamicFormService;onClose=new e.vpe;ticketState;subscriptions=[];constructor(t){this.ticketDynamicFormService=t}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe(t=>{this.ticketState=t}))}handlePreviousStep(){this.ticketDynamicFormService.previousStep()}handleNextStep(){this.ticketDynamicFormService.nextStep()}handleSubmit(){this.ticketDynamicFormService.save(),this.onClose.observed&&this.onClose.emit()}static \u0275fac=function(o){return new(o||i)(e.Y36(p))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-buttons"]],outputs:{onClose:"onClose"},decls:5,vars:2,consts:[[1,"row","align-center","justify-center","mt-4"],[1,"col-1"],[1,"row"],["iconLeft","chevron-back-outline","label","Anterior",3,"onClick",4,"ngIf"],["iconRight","chevron-forward-outline","label","Pr\xf3ximo",3,"onClick",4,"ngIf"],["iconLeft","chevron-back-outline","label","Anterior",3,"onClick"],["iconRight","chevron-forward-outline","label","Pr\xf3ximo",3,"onClick"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,ue,1,0,"rca-button",3),e.YNc(4,pe,1,0,"rca-button",4),e.qZA()()()),2&o&&(e.xp6(3),e.Q6J("ngIf",n.ticketState.previousStepVisible),e.xp6(1),e.Q6J("ngIf",n.ticketState.nextStepVisible))},dependencies:[l.O5,h.m],encapsulation:2})}return i})();function de(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"rca-ticket-dynamic-form-card",4),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.handleSelectItem(c))}),e.qZA(),e.BQk()}if(2&i){const t=s.$implicit,o=e.oxw();e.xp6(1),e.Q6J("title",t.description)("selected",o.selectedItem&&o.selectedItem.id==t.id)}}let fe=(()=>{class i extends B.y{categoryBrowseService;ticketDynamicFormService;onSelectItem=new e.vpe;items=[];selectedItem;constructor(t,o,n){super(t),this.categoryBrowseService=o,this.ticketDynamicFormService=n}ngOnInit(){this.initialLoad()}initialLoad(){const o=this.ticketDynamicFormService.formCategory.value;o.sob_category_id?o.sob_category_id&&this.loadSubCategories(o.sob_category_id):this.loadCategories()}loadCategories(t){this.subscriptions.push(this.categoryBrowseService.getCategories((t||this.ticketDynamicFormService.company).id).pipe((0,_.q)(1)).subscribe(n=>{n.length>0?this.items=n:(this.alertService.toastInfo({title:"Aten\xe7\xe3o",message:"N\xe3o existem categorias cadastradas para essa empresa."}),this.router.navigate(["../"],{relativeTo:this.route}))}))}loadSubCategories(t){this.subscriptions.push(this.categoryBrowseService.getSubCategories(t).pipe((0,_.q)(1)).subscribe(o=>{this.items=o}))}loadSobCategories(t){this.subscriptions.push(this.categoryBrowseService.getSobCategories(t).pipe((0,_.q)(1)).subscribe(o=>{this.items=o}))}handleSelectItem(t){this.selectedItem?.id!=t.id&&(this.selectedItem=t,this.ticketDynamicFormService.removeNext()),y.N.nextOnSelect&&this.handleClickNext()}handleClickNext(){this.selectedItem&&this.ticketDynamicFormService.setCategory(this.selectedItem).nextStep()}handleClickPrevious(){this.ticketDynamicFormService.previousStep()}static \u0275fac=function(o){return new(o||i)(e.Y36(e.zs3),e.Y36(k.w),e.Y36(p))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-category"]],outputs:{onSelectItem:"onSelectItem"},features:[e.qOj],decls:4,vars:1,consts:[[1,"row"],[1,"col-12","m-3",3,"onNext","onPrevious"],[1,"col-12","flex-column","justify-center","align-center"],[4,"ngFor","ngForOf"],[1,"col-3",3,"title","selected","click"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"rca-ticket-dynamic-form-buttons",1),e.NdJ("onNext",function(){return n.handleClickNext()})("onPrevious",function(){return n.handleClickPrevious()}),e.qZA()(),e.TgZ(2,"div",2),e.YNc(3,de,2,2,"ng-container",3),e.qZA()),2&o&&(e.xp6(3),e.Q6J("ngForOf",n.items))},dependencies:[l.sg,Y,F],encapsulation:2})}return i})();const ge=function(i){return{selected:i}};function he(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"rca-ticket-dynamic-form-card",7),e.NdJ("click",function(){const c=e.CHM(t).$implicit,m=e.oxw(3);return e.KtG(m.handleSelectItem(c))}),e.qZA(),e.BQk()}if(2&i){const t=s.$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("title",t.fantasy_name)("selected",(null==o.selectedItem?null:o.selectedItem.id)==(null==t?null:t.id))("ngClass",e.VKq(3,ge,(null==o.selectedItem?null:o.selectedItem.id)==(null==t?null:t.id)))}}function ye(i,s){if(1&i&&(e.ynx(0),e.YNc(1,he,2,5,"ng-container",6),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.items)}}function _e(i,s){if(1&i&&(e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"rca-ticket-dynamic-form-buttons",3),e.qZA(),e.TgZ(3,"div",4),e.YNc(4,ye,2,1,"ng-container",5),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("hidden",t.ticketState.step>0),e.xp6(3),e.Q6J("ngIf",t.items)}}let ve=(()=>{class i{router;route;companyBrowseService;ticketDynamicFormService;authService;items=[];selectedItem;ticketState=b;subscriptions=[];constructor(t,o,n,c,m){this.router=t,this.route=o,this.companyBrowseService=n,this.ticketDynamicFormService=c,this.authService=m}ngOnInit(){this.ticketDynamicFormService.state.subscribe(t=>{this.ticketState=t}),this.subscriptions.push(this.authService.state.subscribe(t=>{this.handleLoadData()}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}handleLoadData(){this.companyBrowseService.selectMany().pipe((0,_.q)(1)).subscribe(t=>{t.length>1?(this.selectedItem=void 0,this.items=t):1==t.length?(this.items=t,this.handleSelectItem(t[0])):this.router.navigate(["../"],{relativeTo:this.route})})}handleSelectItem(t){t&&(this.selectedItem&&this.selectedItem.id!=t.id&&this.ticketDynamicFormService.removeNext(),this.selectedItem=t),y.N.nextOnSelect&&this.handleClickNext()}handleClickNext(){this.selectedItem&&this.ticketDynamicFormService.setCompanies(this.items).setCompany(this.selectedItem).nextStep()}handleClickPrevious(){this.ticketDynamicFormService.previousStep()}static \u0275fac=function(o){return new(o||i)(e.Y36(g.F0),e.Y36(g.gz),e.Y36(C.$),e.Y36(p),e.Y36(O.e))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-company"]],decls:1,vars:1,consts:[["class","row justify-center",4,"ngIf"],[1,"row","justify-center"],[1,"row",3,"hidden"],[1,"col-12","m-3"],[1,"col-4"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-12","p-3",3,"title","selected","ngClass","click"]],template:function(o,n){1&o&&e.YNc(0,_e,5,2,"div",0),2&o&&e.Q6J("ngIf",0==n.ticketState.step)},dependencies:[l.mk,l.sg,l.O5,Y,F],encapsulation:2})}return i})();function Ce(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",4),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.handleChangeStep(0,0))}),e.TgZ(1,"a"),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(2),e.Oqu(t.company.fantasy_name)}}const ke=function(i){return{"is-active":i}};function Te(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",6),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().index,c=e.oxw(2);return e.KtG(c.handleChangeStep(1,n))}),e.TgZ(1,"a"),e._uU(2),e.qZA()()}if(2&i){const t=e.oxw(),n=t.$implicit;e.Q6J("ngClass",e.VKq(2,ke,t.last)),e.xp6(2),e.Oqu(n.description)}}function xe(i,s){if(1&i&&(e.ynx(0),e.YNc(1,Te,3,4,"li",5),e.BQk()),2&i){const t=s.index,o=s.last,n=e.oxw(2);e.xp6(1),e.Q6J("ngIf",n.ticketState.stepCategory>t||n.ticketState.step>1&&o)}}function Se(i,s){if(1&i&&(e.TgZ(0,"ul"),e.YNc(1,Ce,3,1,"li",2),e.YNc(2,xe,2,1,"ng-container",3),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.ticketState.step>0),e.xp6(1),e.Q6J("ngForOf",t.categories)}}let be=(()=>{class i{ticketDynamicFormService;onClose=new e.vpe;ticketState;subscriptions=[];get company(){return this.ticketDynamicFormService.company}get categories(){return this.ticketDynamicFormService.formCategories.value}constructor(t){this.ticketDynamicFormService=t}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe(t=>{this.ticketState=t}))}handleChangeStep(t,o){this.ticketDynamicFormService.setStep(t,o)}static \u0275fac=function(o){return new(o||i)(e.Y36(p))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-header"]],outputs:{onClose:"onClose"},decls:4,vars:1,consts:[["aria-label","breadcrumbs",1,"breadcrumb"],[4,"ngIf"],[3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"],[3,"ngClass","click",4,"ngIf"],[3,"ngClass","click"]],template:function(o,n){1&o&&(e.TgZ(0,"h1"),e._uU(1,"Novo Ticket"),e.qZA(),e.TgZ(2,"nav",0),e.YNc(3,Se,3,2,"ul",1),e.qZA()),2&o&&(e.xp6(3),e.Q6J("ngIf",n.company))},dependencies:[l.mk,l.sg,l.O5],encapsulation:2})}return i})();function Fe(i,s){if(1&i&&(e.ynx(0),e._UZ(1,"rca-ticket-dynamic-form-category",8),e.BQk()),2&i){const t=s.index,o=e.oxw(3);e.xp6(1),e.Q6J("hidden",1!=o.ticketState.step||o.ticketState.stepCategory!=t)}}function Ze(i,s){if(1&i&&(e.ynx(0),e.YNc(1,Fe,2,1,"ng-container",7),e.BQk()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",null==t.formCategories?null:t.formCategories.controls)}}function De(i,s){1&i&&(e.ynx(0),e.TgZ(1,"div",5),e._UZ(2,"rca-ticket-dynamic-form-buttons",9),e.qZA(),e.TgZ(3,"div",5),e._UZ(4,"rca-edit-text",10)(5,"rca-textarea",11),e.qZA(),e.BQk()),2&i&&(e.xp6(5),e.Q6J("minHeight",200))}function we(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"rca-button",12),e.NdJ("onClick",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.handleSubmit())}),e.qZA()}}function Je(i,s){if(1&i&&(e.TgZ(0,"form",1),e._UZ(1,"rca-ticket-dynamic-form-company"),e.YNc(2,Ze,2,1,"ng-container",2),e.YNc(3,De,6,1,"ng-container",2),e.ynx(4),e.TgZ(5,"div",3)(6,"div",4)(7,"div",5),e.YNc(8,we,1,0,"rca-button",6),e.qZA()()(),e.BQk(),e.qZA()),2&i){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("ngIf",t.formCategories),e.xp6(1),e.Q6J("ngIf",2==t.ticketState.step),e.xp6(5),e.Q6J("ngIf",2==t.ticketState.step)}}let Me=(()=>{class i extends B.y{ticketDynamicFormService;ticketState;get form(){return this.ticketDynamicFormService.form}get formCategories(){return this.ticketDynamicFormService.formCategories}constructor(t,o){super(t),this.ticketDynamicFormService=o}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe({next:t=>{this.ticketState=t}}))}handleSubmit(){this.ticketDynamicFormService.save().subscribe(t=>{this.navigateToBrowse()})}navigateToBrowse=()=>{this.form.reset(),this.router.navigate([".."],{relativeTo:this.route})};static \u0275fac=function(o){return new(o||i)(e.Y36(e.zs3),e.Y36(p))};static \u0275cmp=e.Xpm({type:i,selectors:[["rca-ticket-dynamic-form"]],features:[e._Bn([p,k.w]),e.qOj],decls:2,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngIf"],[1,"row","align-center","justify-center","mt-4"],[1,"col-1"],[1,"row"],["type","success","iconLeft","save","label","Gravar",3,"onClick",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"hidden"],[1,"col-12","m-3"],["label","Assunto","formControlName","title",1,"col-12"],["label","Descri\xe7\xe3o","formControlName","description",1,"col-12",3,"minHeight"],["type","success","iconLeft","save","label","Gravar",3,"onClick"]],template:function(o,n){1&o&&(e._UZ(0,"rca-ticket-dynamic-form-header"),e.YNc(1,Je,9,4,"form",0)),2&o&&(e.xp6(1),e.Q6J("ngIf",n.form))},dependencies:[l.sg,l.O5,h.m,T.V,x,a._Y,a.JJ,a.JL,a.sg,a.u,fe,ve,F,be],encapsulation:2})}return i})();var Ne=r(6760),Ie=r(684),Qe=r(200);let Ae=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=e.oAB({type:i});static \u0275inj=e.cJS({imports:[l.ez,Ne.m,Ie.A,Qe.e]})}return i})();const Oe=[{path:"",component:ae,pathMatch:"full"},{path:"dynamic",component:Me,pathMatch:"full"},{path:"new",component:f,pathMatch:"full"},{path:":id/view",component:f,pathMatch:"full"},{path:":id/edit",component:f,pathMatch:"full"},{path:":id/delete",component:f,pathMatch:"full"}];let Be=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=e.oAB({type:i});static \u0275inj=e.cJS({imports:[Ae,g.Bz.forChild(Oe),g.Bz]})}return i})()}}]);