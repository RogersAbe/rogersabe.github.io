"use strict";(self.webpackChunkAngular_Base=self.webpackChunkAngular_Base||[]).push([[2],{6002:(Kt,F,r)=>{r.r(F),r.d(F,{TicketModule:()=>Lt});var l=r(6814),O=r(6208),p=r(9284);const A_browse=[{column:"company.fantasy_name",title:"Empresa"},{column:"title",title:"T\xedtulo"},{column:"created_at",title:"Criado"},{column:"requester.name",title:"Solicitante"},{column:"assigned.name",title:"Atribu\xeddo"},{column:"category.description",title:"Categoria"},{column:"priority",title:"Prioridade"}];var t=r(4946),D=r(9277);let f=(()=>{class i extends D.S{injector;constructor(e){super(e),this.injector=e,this.api="ticket"}static \u0275fac=function(n){return new(n||i)(t.LFG(t.zs3))};static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var Q=r(2325),C=r(9319),J=r(3076),a=r(95),v=r(2333),y=r(1742),k=r(7525),T=r(5261),Y=r(5537),N=r(1427);function q(i,c){}function H(i,c){if(1&i&&t._UZ(0,"rca-skeleton",3),2&i){const e=t.oxw();t.Q6J("owner",e)}}function U(i,c){if(1&i&&(t.TgZ(0,"span",7),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errorMessage," ")}}function B(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",4)(1,"label"),t._uU(2),t.qZA(),t.TgZ(3,"input",5),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.value=o)})("change",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.onChangeValue(o))}),t.qZA(),t.YNc(4,U,2,1,"span",6),t.qZA()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.label),t.xp6(1),t.Q6J("id",e.elementId)("ngModel",e.value)("ngClass",e.className)("placeholder",e.placeholder)("disableControl",e.disabled||e.page.disabled),t.xp6(1),t.Q6J("ngIf",!e.valid&&e.errorMessage)}}let E=(()=>{class i extends T.C{onChangeValue(e){this.handleChange(e.target.value)}static \u0275fac=function(){let e;return function(o){return(e||(e=t.n5z(i)))(o||i)}}();static \u0275cmp=t.Xpm({type:i,selectors:[["rca-edit-date"]],features:[t._Bn([{provide:a.JU,useExisting:i,multi:!0}]),t.qOj],decls:5,vars:1,consts:[[3,"ngTemplateOutlet"],["loadingTemplate",""],["loadedTemplate",""],[3,"owner"],[1,"control"],["type","date",1,"input","is-hovered","is-small",3,"id","ngModel","ngClass","placeholder","disableControl","ngModelChange","change"],["class","has-text-danger",4,"ngIf"],[1,"has-text-danger"]],template:function(n,o){if(1&n&&(t.YNc(0,q,0,0,"ng-template",0),t.YNc(1,H,1,1,"ng-template",null,1,t.W1O),t.YNc(3,B,5,7,"ng-template",null,2,t.W1O)),2&n){const s=t.MAs(2),m=t.MAs(4);t.Q6J("ngTemplateOutlet",o.page.loading||!o.page.initialized?s:m)}},dependencies:[l.mk,l.O5,l.tP,a.Fj,a.JJ,a.On,Y.d,N._],encapsulation:2})}return i})();var G=r(420),L=r(8808),z=r(8767);const K=["input"];function j(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"rca-skeleton",1),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("owner",e)}}function P(i,c){if(1&i&&(t.TgZ(0,"span",6),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errorMessage," ")}}const V=function(i){return{disabled:i}};function $(i,c){if(1&i){const e=t.EpF();t.ynx(0),t._uU(1),t.ALo(2,"pure"),t.TgZ(3,"div",2)(4,"label"),t._uU(5),t.qZA(),t.TgZ(6,"angular-editor",3,4),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.value=o)})("blur",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.onChangeValue(o))}),t.qZA(),t.YNc(8,P,2,1,"span",5),t.qZA(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,8,e.logRender)," "),t.xp6(4),t.Oqu(e.label),t.xp6(1),t.Q6J("ngClass",t.VKq(10,V,e.disabled||e.page.disabled))("ngModel",e.value)("config",e.editorConfig)("ariaRowSpan",100)("minHeight",e.minHeight),t.xp6(2),t.Q6J("ngIf",!e.valid&&e.errorMessage)}}let x=(()=>{class i extends T.C{minHeight=1;input;editorConfig;ngOnInit(){super.ngOnInit();const e=this.disabled||this.page.disabled;this.editorConfig={editable:!e,spellcheck:!e,height:"auto",minHeight:"20vh",maxHeight:"auto",width:"auto",minWidth:"0",translate:"yes",enableToolbar:!e,showToolbar:!e,placeholder:"Enter text here...",defaultParagraphSeparator:"",defaultFontName:"",defaultFontSize:"",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],customClasses:[{name:"quote",class:"quote"},{name:"redText",class:"redText"},{name:"titleText",class:"titleText",tag:"h1"}],sanitize:!0,toolbarPosition:"top",toolbarHiddenButtons:[["bold","italic"],["fontSize"]]}}onChangeValue(e){this.handleChange(e.target.innerHTML)}static \u0275fac=function(){let e;return function(o){return(e||(e=t.n5z(i)))(o||i)}}();static \u0275cmp=t.Xpm({type:i,selectors:[["rca-textarea"]],viewQuery:function(n,o){if(1&n&&t.Gf(K,5),2&n){let s;t.iGM(s=t.CRH())&&(o.input=s.first)}},inputs:{minHeight:"minHeight"},features:[t._Bn([{provide:a.JU,useExisting:i,multi:!0}]),t.qOj],decls:2,vars:2,consts:[[4,"ngIf"],[3,"owner"],["loading","",1,"control"],[3,"ngClass","ngModel","config","ariaRowSpan","minHeight","ngModelChange","blur"],["input",""],["class","has-text-danger",4,"ngIf"],[1,"has-text-danger"]],template:function(n,o){1&n&&(t.YNc(0,j,2,1,"ng-container",0),t.YNc(1,$,9,12,"ng-container",0)),2&n&&(t.Q6J("ngIf",!o.page.initialized),t.xp6(1),t.Q6J("ngIf",o.page.initialized))},dependencies:[l.mk,l.O5,a.JJ,a.On,G.s6,L.T,N._,z.J],encapsulation:2})}return i})();var R=r(9144),X=r(2193),d=r(3209);let w=(()=>{class i extends D.S{injector;constructor(e){super(e),this.injector=e,this.api="ticket-history"}static \u0275fac=function(n){return new(n||i)(t.LFG(t.zs3))};static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"})}return i})();var b=r(6619),W=r(1073),tt=r(7624);function et(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"h1"),t._uU(2,"Nova observa\xe7\xe3o"),t.qZA(),t.TgZ(3,"form",3),t._UZ(4,"rca-textarea",4)(5,"rca-edit-text",5),t.qZA(),t.TgZ(6,"div",6)(7,"button",7),t.NdJ("click",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.handleOnSubmit(o))}),t._uU(8," Gravar "),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("formGroup",e.formGroup)}}let I=(()=>{class i extends b.y{ticketHistoryService;ticket;onClose=new t.vpe;formGroup;constructor(e,n){super(e),this.ticketHistoryService=n}ngOnInit(){super.ngOnInit(),this.formGroup=this.formBuilder.group({ticket:[this.ticket.id],company:[this.ticket.company.id],description:["",[a.kI.required]],time:[0,[a.kI.required]]}),this.pageService.setInitialized()}handleOnSubmit(e){if(!W.Z.validateForm(this.formGroup))return this.alertService.toastDanger({title:"Aten\xe7\xe3o",message:"Verifique os campos obrigat\xf3rios."}),void e.preventDefault();this.ticketHistoryService.insert(this.formGroup.value).subscribe(n=>{this.onClose.emit(!0)})}static \u0275fac=function(n){return new(n||i)(t.Y36(t.zs3),t.Y36(w))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-message-form"]],inputs:{ticket:"ticket"},outputs:{onClose:"onClose"},features:[t._Bn([d.Z]),t.qOj],decls:3,vars:0,consts:[[3,"onClose"],["full",""],[1,"block"],[3,"formGroup"],["formControlName","description","label","Descri\xe7\xe3o",1,"col-12"],["type","number","formControlName","time","label","Tempo",1,"col-12"],[1,"row","flex","align-end","justify-end","mt-2"],[1,"button","is-link","is-left",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"rca-modal",0),t.NdJ("onClose",function(){return o.onClose.emit(!0)}),t.YNc(1,et,9,1,"ng-template",null,1,t.W1O),t.qZA())},dependencies:[k.V,x,a._Y,a.JJ,a.JL,a.sg,a.u,tt.z],encapsulation:2})}return i})();function it(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"rca-ticket-message-form",7),t.NdJ("onClose",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.onCloseModalForm(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ticket",e.ticket)}}function nt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div",9)(1,"div",10)(2,"div")(3,"span",11)(4,"strong"),t._uU(5),t.qZA()(),t.TgZ(6,"small"),t._uU(7),t.qZA(),t._uU(8," - "),t.TgZ(9,"span"),t._uU(10),t.qZA()(),t.TgZ(11,"ion-icon",12),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.handleClickDelete(s))}),t.qZA()(),t._UZ(12,"div",13),t.qZA()}if(2&i){const e=c.$implicit;t.xp6(5),t.Oqu(e.user.name),t.xp6(2),t.Oqu(e.created_at),t.xp6(3),t.Oqu(e.time),t.xp6(2),t.Q6J("innerHTML",e.description,t.oJD)}}function ot(i,c){if(1&i&&(t.ynx(0),t.YNc(1,nt,13,4,"div",8),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.items)}}let ct=(()=>{class i{ticketHistoryService;pageService;ticket;onDelete=new t.vpe;items=[];modalTicketMessageVisible=!1;constructor(e,n){this.ticketHistoryService=e,this.pageService=n}ngOnInit(){this.handleLoadData()}handleLoadData(){this.ticketHistoryService.selectMany({ticket_id:this.ticket.id}).subscribe(e=>{this.items=e,this.pageService.setInitialized()})}handleClickDelete(e){this.ticketHistoryService.delete(e.id).subscribe(n=>{this.handleLoadData()})}handleOpenModalForm(){this.modalTicketMessageVisible=!0}onCloseModalForm(e){this.modalTicketMessageVisible=!1,e&&this.handleLoadData()}static \u0275fac=function(n){return new(n||i)(t.Y36(w),t.Y36(d.Z))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-message-list"]],inputs:{ticket:"ticket"},features:[t._Bn([d.Z])],decls:10,vars:2,consts:[[3,"ticket","onClose",4,"ngIf"],[1,"mt-2"],[1,"col-12","flex","justify-content-end"],[1,"button","is-small","is-warning",3,"click"],[1,"icon","is-small"],["name","clipboard-outline"],[4,"ngIf"],[3,"ticket","onClose"],["class","mt-2","style","border: 1px solid #ddd; padding: 5px",4,"ngFor","ngForOf"],[1,"mt-2",2,"border","1px solid #ddd","padding","5px"],[1,"col-12","flex","align-items-center","justify-space-between"],[1,"mr-2"],["name","trash-outline",1,"pointer","p-2",3,"click"],[3,"innerHTML"]],template:function(n,o){1&n&&(t.YNc(0,it,1,1,"rca-ticket-message-form",0),t.TgZ(1,"h2",1),t._uU(2,"Historico de atividades"),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return o.handleOpenModalForm()}),t.TgZ(5,"span"),t._uU(6,"Nova Observa\xe7\xe3o"),t.qZA(),t.TgZ(7,"span",4),t._UZ(8,"ion-icon",5),t.qZA()()(),t.YNc(9,ot,2,1,"ng-container",6)),2&n&&(t.Q6J("ngIf",o.modalTicketMessageVisible),t.xp6(9),t.Q6J("ngIf",o.items.length))},dependencies:[l.sg,l.O5,I],encapsulation:2})}return i})();function st(i,c){1&i&&t._UZ(0,"rca-category-browse",18),2&i&&t.Q6J("config",c.$implicit)}function rt(i,c){1&i&&t._UZ(0,"rca-category-form",18),2&i&&t.Q6J("config",c.$implicit)}function at(i,c){1&i&&t._UZ(0,"rca-user-browse",18),2&i&&t.Q6J("config",c.$implicit)}function lt(i,c){1&i&&t._UZ(0,"rca-user-form",18),2&i&&t.Q6J("config",c.$implicit)}function mt(i,c){1&i&&t._UZ(0,"rca-user-browse",18),2&i&&t.Q6J("config",c.$implicit)}function pt(i,c){1&i&&t._UZ(0,"rca-user-form",18),2&i&&t.Q6J("config",c.$implicit)}function ut(i,c){if(1&i&&t._UZ(0,"rca-ticket-message-list",19),2&i){const e=t.oxw();t.Q6J("ticket",e.formGroup.value)}}let g=(()=>{class i{formBuilder;authService;ticketService;companyService;userService;categoryService;config;formGroup;constructor(e,n,o,s,m,zt){this.formBuilder=e,this.authService=n,this.ticketService=o,this.companyService=s,this.userService=m,this.categoryService=zt}ngOnInit(){this.formGroup=this.formBuilder.group({id:[""],title:[""],description:[""],start_date:[new Date],end_date:[],created_at:[new Date],updated_at:[],client:[],company:[],category:[],priority:[],requester:[this.authService.user],assigned:[],assigned_id:[""],ticket_times:[[]],ticket_observers:[[]],ticket_histories:[[]]})}static \u0275fac=function(n){return new(n||i)(t.Y36(a.qu),t.Y36(v.e),t.Y36(f),t.Y36(C.J),t.Y36(J.K),t.Y36(y.H))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-form"]],inputs:{config:"config"},features:[t._Bn([f,J.K,C.J])],decls:34,vars:15,consts:[["title","Cadastro de Tickets",3,"config","formGroup","service"],["pageEl",""],[1,"row"],["label","Solicitante","formControlName","requester","colDescription","name",1,"col-9",3,"disable","service"],["elRequester",""],["label","Criado em","formControlName","created_at",1,"col-3",3,"readonly","autofocus"],["label","T\xedtulo","formControlName","title",1,"col-12"],["label","Descri\xe7\xe3o","formControlName","description",1,"col-12",3,"autofocus"],["label","Prioridade","formControlName","priority",1,"col-6"],["label","Categoria","formControlName","category","colDescription","description",1,"col-6",3,"service"],["searchTemplate",""],["formTemplate",""],["label","Atribu\xeddo","formControlName","assigned","colDescription","name",1,"col-8",3,"service"],[1,"col-4"],["label","Data Inicial","formControlName","start_date",1,"col-6",3,"autofocus"],["label","Data Final","formControlName","end_date",1,"col-6",3,"autofocus"],["label","Observadores","formControlName","ticket_observers","colDescription","name",1,"col-12",3,"service","multiple"],[3,"ticket",4,"ngIf"],[3,"config"],[3,"ticket"]],template:function(n,o){1&n&&(t.TgZ(0,"rca-page-form",0,1)(2,"div",2),t._UZ(3,"rca-auto-complete",3,4)(5,"rca-edit-date",5),t.qZA(),t.TgZ(6,"div",2),t._UZ(7,"rca-edit-text",6),t.qZA(),t.TgZ(8,"div",2),t._UZ(9,"rca-textarea",7),t.qZA(),t.TgZ(10,"div",2),t._UZ(11,"rca-edit-text",8),t.TgZ(12,"rca-auto-complete",9),t.YNc(13,st,1,1,"ng-template",null,10,t.W1O),t.YNc(15,rt,1,1,"ng-template",null,11,t.W1O),t.qZA()(),t.TgZ(17,"div",2)(18,"rca-auto-complete",12),t.YNc(19,at,1,1,"ng-template",null,10,t.W1O),t.YNc(21,lt,1,1,"ng-template",null,11,t.W1O),t.qZA(),t.TgZ(23,"div",13)(24,"div",2),t._UZ(25,"rca-edit-date",14)(26,"rca-edit-date",15),t.qZA()()(),t.TgZ(27,"div",2)(28,"rca-auto-complete",16),t.YNc(29,mt,1,1,"ng-template",null,10,t.W1O),t.YNc(31,pt,1,1,"ng-template",null,11,t.W1O),t.qZA()(),t.YNc(33,ut,1,1,"rca-ticket-message-list",17),t.qZA()),2&n&&(t.Q6J("config",o.config)("formGroup",o.formGroup)("service",o.ticketService),t.xp6(3),t.Q6J("disable",!0)("service",o.userService),t.xp6(2),t.Q6J("readonly",!0)("autofocus",!0),t.xp6(4),t.Q6J("autofocus",!0),t.xp6(3),t.Q6J("service",o.categoryService),t.xp6(6),t.Q6J("service",o.userService),t.xp6(7),t.Q6J("autofocus",!0),t.xp6(1),t.Q6J("autofocus",!0),t.xp6(2),t.Q6J("service",o.userService)("multiple",!0),t.xp6(5),t.Q6J("ngIf",o.formGroup.value.id))},dependencies:[l.O5,k.V,E,x,R.j,a.JJ,a.JL,a.sg,a.u,X.i,ct],encapsulation:2})}return i})();function dt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"rca-ticket-message-form",5),t.NdJ("onClose",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.onCloseModalMessage(o))}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ticket",e.selectedRow)}}function gt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.onClickNewDynamic())}),t.TgZ(1,"span"),t._uU(2,"Novo"),t.qZA(),t.TgZ(3,"span",7),t._UZ(4,"ion-icon",8),t.qZA()()}}function ft(i,c){1&i&&t._UZ(0,"rca-ticket-form",9),2&i&&t.Q6J("config",c.$implicit)}function _t(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.handleOpenModalForm(s))}),t.TgZ(1,"span",7),t._UZ(2,"ion-icon",11),t.qZA()()}2&i&&t.Q6J("disabled",c.$implicit.deleted)}let ht=(()=>{class i{route;router;ticketService;config;columns=A_browse;selectedRow;constructor(e,n,o){this.route=e,this.router=n,this.ticketService=o}onClickNewDynamic(){this.router.navigate(["dynamic"],{relativeTo:this.route})}onCloseModalMessage(e){this.selectedRow=void 0}handleOpenModalForm(e){this.selectedRow=e}static \u0275fac=function(n){return new(n||i)(t.Y36(p.gz),t.Y36(p.F0),t.Y36(f))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-browse"]],inputs:{config:"config"},decls:8,vars:4,consts:[[3,"ticket","onClose",4,"ngIf"],["title","Tickets",3,"config","service","columns"],["customActionsTemplate",""],["formTemplate",""],["tableActionsTemplate",""],[3,"ticket","onClose"],[1,"flex-1","ml-1","button","is-small","is-success",2,"background","#ee6634",3,"click"],[1,"icon","is-small"],["name","add"],[3,"config"],[1,"button","is-small","is-link","mh-1",3,"disabled","click"],["name","clipboard-outline"]],template:function(n,o){1&n&&(t.YNc(0,dt,1,1,"rca-ticket-message-form",0),t.TgZ(1,"rca-page-browse",1),t.YNc(2,gt,5,0,"ng-template",null,2,t.W1O),t.YNc(4,ft,1,1,"ng-template",null,3,t.W1O),t.YNc(6,_t,3,1,"ng-template",null,4,t.W1O),t.qZA()),2&n&&(t.Q6J("ngIf",o.selectedRow),t.xp6(1),t.Q6J("config",o.config)("service",o.ticketService)("columns",o.columns))},dependencies:[l.O5,Q.P,g,I],encapsulation:2})}return i})();var Ct=r(5619),_=r(553);const S={step:0,stepCategory:0,stepLast:0,nextStepVisible:!1,previousStepVisible:!1,countCompanies:0};let u=(()=>{class i{fb;ticketService;authService;state;form;activeCategory;companies=[];subscriptions=[];get value(){return this.state.value}get step(){return this.value.step}get categories(){return this.form.get("categories")?.value}get company(){return this.form.get("company")?.value}get stepCategory(){return this.value.stepCategory}get formCategories(){return this.form.get("categories")}get formCategory(){return this.formCategories.controls[this.stepCategory]}constructor(e,n,o){this.fb=e,this.ticketService=n,this.authService=o,this.state=new Ct.X(S),this.form=this.fb.group({company:[],title:[""],description:[""],start_date:[new Date],end_date:[""],created_at:[new Date],updated_at:[""],category:[""],priority:[""],requester:[this.authService.user],assigned:[""],assigned_id:[""],ticket_times:[[]],ticket_observers:[[]],categories:this.fb.array([])}),this.subscriptions.push(this.authService.state.subscribe(s=>{const m={...S};this.setState(m)}))}ngOnInit(){}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}newCategory(e=0){const n=this.formCategory?.get("id")?.value||"";this.formCategories.controls[this.stepCategory+e]||(this.activeCategory=this.fb.group({id:[],description:[],sob_category_id:[n],sob_categories:[],sub_categories:[]}),this.formCategories.push(this.activeCategory))}setState(e){const n={...e,stepLast:e.stepLast<e.step?e.step:e.stepLast,previousStepVisible:this.previousStepVisible(e),nextStepVisible:this.nextStepVisible(e)};return this.state.next(n),this}setStep(e,n){return this.setState({...this.value,step:e,stepCategory:n})}setCompanies(e){return this.companies=e,this}setCompany(e){return this.form.patchValue({company:e}),this}setCategory(e){return this.formCategory&&this.formCategory.patchValue(e),this}previousStep(){const e={...this.value};1==this.step?(this.formCategory.value.id||this.formCategories.removeAt(this.stepCategory),this.stepCategory>0?e.stepCategory--:e.step--):2==this.step&&e.step--,this.setState(e)}previousStepVisible(e){return 1==e.step?0!=e.stepCategory||this.companies.length>0:e.step>0}nextStep(){const e={...this.value};0==this.step?(this.newCategory(),e.step++):1==this.step&&this.formCategory&&(this.formCategory?.value?.sub_categories?.length?(this.newCategory(1),e.stepCategory++):e.step++),this.setState(e)}nextStepVisible(e){if(this.categories.length)switch(e.step){case 0:return!_.N.nextOnSelect||!!this.categories[0]?.id;case 1:return e.stepCategory<this.categories.length-1||!!this.categories[e.stepCategory].id;default:return _.N.nextOnSelect&&e.step<2}return!1}save(){return this.ticketService.save({...this.form.value,category:this.formCategory.value})}removeNext(e=!1){const n=0==this.step?0:this.stepCategory+(e?0:1);for(let o=this.formCategories.length-1;o>=n;o--)this.formCategories.removeAt(o)}static \u0275fac=function(n){return new(n||i)(t.LFG(a.qu),t.LFG(f),t.LFG(v.e))};static \u0275prov=t.Yz7({token:i,factory:i.\u0275fac})}return i})();var h=r(8180);const vt=function(i){return{selected:i}};let M=(()=>{class i extends T.C{title="";selected=!1;static \u0275fac=function(){let e;return function(o){return(e||(e=t.n5z(i)))(o||i)}}();static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-card"]],inputs:{title:"title",selected:"selected"},features:[t._Bn([d.Z,{provide:a.JU,useExisting:i,multi:!0}]),t.qOj],decls:3,vars:4,consts:[[1,"box","p-2","m-2",3,"ngClass"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"p"),t._uU(2),t.qZA()()),2&n&&(t.Q6J("ngClass",t.VKq(2,vt,o.selected)),t.xp6(2),t.Oqu(o.title))},dependencies:[l.mk],styles:["[_nghost-%COMP%]{display:grid;font-size:1.5rem;text-align:center}[_nghost-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:#6091ed!important;color:#fff}[_nghost-%COMP%]:hover{cursor:pointer}"]})}return i})();function yt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.handlePreviousStep())}),t.TgZ(1,"span",5),t._UZ(2,"ion-icon",6),t.qZA()()}}function kt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.handleNextStep())}),t.TgZ(1,"span",5),t._UZ(2,"ion-icon",7),t.qZA()()}}let Z=(()=>{class i{ticketDynamicFormService;onClose=new t.vpe;ticketState;subscriptions=[];constructor(e){this.ticketDynamicFormService=e}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe(e=>{this.ticketState=e}))}handlePreviousStep(){this.ticketDynamicFormService.previousStep()}handleNextStep(){this.ticketDynamicFormService.nextStep()}handleSubmit(){this.ticketDynamicFormService.save(),this.onClose.observed&&this.onClose.emit()}static \u0275fac=function(n){return new(n||i)(t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-buttons"]],outputs:{onClose:"onClose"},decls:5,vars:2,consts:[[1,"row","align-center","justify-center","mt-4"],[1,"col-1"],[1,"row"],["class","col-6 button is-small is-info",3,"click",4,"ngIf"],[1,"col-6","button","is-small","is-info",3,"click"],[1,"icon","is-small"],["name","chevron-back-outline"],["name","chevron-forward-outline"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,yt,3,0,"button",3),t.YNc(4,kt,3,0,"button",3),t.qZA()()()),2&n&&(t.xp6(3),t.Q6J("ngIf",o.ticketState.previousStepVisible),t.xp6(1),t.Q6J("ngIf",o.ticketState.nextStepVisible))},dependencies:[l.O5],encapsulation:2})}return i})();function Tt(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"rca-ticket-dynamic-form-card",4),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.handleSelectItem(s))}),t.qZA(),t.BQk()}if(2&i){const e=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("title",e.description)("selected",n.selectedItem&&n.selectedItem.id==e.id)}}let xt=(()=>{class i extends b.y{categoryService;ticketDynamicFormService;onSelectItem=new t.vpe;items=[];selectedItem;constructor(e,n,o){super(e),this.categoryService=n,this.ticketDynamicFormService=o}ngOnInit(){this.initialLoad()}initialLoad(){const n=this.ticketDynamicFormService.formCategory.value;n.sob_category_id?n.sob_category_id&&this.loadSubCategories(n.sob_category_id):this.loadCategories()}loadCategories(e){this.subscriptions.push(this.categoryService.getCategories((e||this.ticketDynamicFormService.company).id).pipe((0,h.q)(1)).subscribe(o=>{o.length>0?this.items=o:(this.alertService.toastInfo({title:"Aten\xe7\xe3o",message:"N\xe3o existem categorias cadastradas para essa empresa."}),this.router.navigate(["../"],{relativeTo:this.route}))}))}loadSubCategories(e){this.subscriptions.push(this.categoryService.getSubCategories(e).pipe((0,h.q)(1)).subscribe(n=>{this.items=n}))}loadSobCategories(e){this.subscriptions.push(this.categoryService.getSobCategories(e).pipe((0,h.q)(1)).subscribe(n=>{this.items=n}))}handleSelectItem(e){this.selectedItem=e,this.ticketDynamicFormService.removeNext(),_.N.nextOnSelect&&this.handleClickNext()}handleClickNext(){this.selectedItem&&this.ticketDynamicFormService.setCategory(this.selectedItem).nextStep()}handleClickPrevious(){this.ticketDynamicFormService.previousStep()}static \u0275fac=function(n){return new(n||i)(t.Y36(t.zs3),t.Y36(y.H),t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-category"]],outputs:{onSelectItem:"onSelectItem"},features:[t.qOj],decls:4,vars:1,consts:[[1,"row"],[1,"col-12","m-3",3,"onNext","onPrevious"],[1,"col-12","flex-column","justify-center","align-center"],[4,"ngFor","ngForOf"],[1,"col-6",3,"title","selected","click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"rca-ticket-dynamic-form-buttons",1),t.NdJ("onNext",function(){return o.handleClickNext()})("onPrevious",function(){return o.handleClickPrevious()}),t.qZA()(),t.TgZ(2,"div",2),t.YNc(3,Tt,2,2,"ng-container",3),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngForOf",o.items))},dependencies:[l.sg,M,Z],encapsulation:2})}return i})();const bt=function(i){return{selected:i}};function St(i,c){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"rca-ticket-dynamic-form-card",7),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(3);return t.KtG(m.handleSelectItem(s))}),t.qZA(),t.BQk()}if(2&i){const e=c.$implicit,n=t.oxw(3);t.xp6(1),t.Q6J("title",e.fantasy_name)("selected",(null==n.selectedItem?null:n.selectedItem.id)==(null==e?null:e.id))("ngClass",t.VKq(3,bt,(null==n.selectedItem?null:n.selectedItem.id)==(null==e?null:e.id)))}}function Zt(i,c){if(1&i&&(t.ynx(0),t.YNc(1,St,2,5,"ng-container",6),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.items)}}function Ft(i,c){if(1&i&&(t.TgZ(0,"div",1)(1,"div",2),t._UZ(2,"rca-ticket-dynamic-form-buttons",3),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,Zt,2,1,"ng-container",5),t.qZA()()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("hidden",e.ticketState.step>0),t.xp6(3),t.Q6J("ngIf",e.items)}}let Dt=(()=>{class i{router;route;companyService;ticketDynamicFormService;authService;items=[];selectedItem;ticketState=S;subscriptions=[];constructor(e,n,o,s,m){this.router=e,this.route=n,this.companyService=o,this.ticketDynamicFormService=s,this.authService=m}ngOnInit(){this.ticketDynamicFormService.state.subscribe(e=>{this.ticketState=e}),this.subscriptions.push(this.authService.state.subscribe(e=>{this.handleLoadData()}))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}handleLoadData(){this.companyService.selectMany().pipe((0,h.q)(1)).subscribe(e=>{e.length>1?(this.selectedItem=void 0,this.items=e):1==e.length?(this.items=e,this.handleSelectItem(e[0])):this.router.navigate(["../"],{relativeTo:this.route})})}handleSelectItem(e){e&&(this.selectedItem&&this.selectedItem.id!=e.id&&this.ticketDynamicFormService.removeNext(),this.selectedItem=e),_.N.nextOnSelect&&this.handleClickNext()}handleClickNext(){this.selectedItem&&this.ticketDynamicFormService.setCompanies(this.items).setCompany(this.selectedItem).nextStep()}handleClickPrevious(){this.ticketDynamicFormService.previousStep()}static \u0275fac=function(n){return new(n||i)(t.Y36(p.F0),t.Y36(p.gz),t.Y36(C.J),t.Y36(u),t.Y36(v.e))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-company"]],decls:1,vars:1,consts:[["class","row justify-center",4,"ngIf"],[1,"row","justify-center"],[1,"row",3,"hidden"],[1,"col-12","m-3"],[1,"col-4"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-12","p-3",3,"title","selected","ngClass","click"]],template:function(n,o){1&n&&t.YNc(0,Ft,5,2,"div",0),2&n&&t.Q6J("ngIf",0==o.ticketState.step)},dependencies:[l.mk,l.sg,l.O5,M,Z],encapsulation:2})}return i})();function Jt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"li",4),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleChangeStep(0,0))}),t.TgZ(1,"a"),t._uU(2),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.company.fantasy_name)}}const Nt=function(i){return{"is-active":i}};function wt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"li",6),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().index,s=t.oxw(2);return t.KtG(s.handleChangeStep(1,o))}),t.TgZ(1,"a"),t._uU(2),t.qZA()()}if(2&i){const e=t.oxw(),o=e.$implicit;t.Q6J("ngClass",t.VKq(2,Nt,e.last)),t.xp6(2),t.Oqu(o.description)}}function It(i,c){if(1&i&&(t.ynx(0),t.YNc(1,wt,3,4,"li",5),t.BQk()),2&i){const e=c.index,n=c.last,o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.ticketState.stepCategory>e||o.ticketState.step>1&&n)}}function Mt(i,c){if(1&i&&(t.TgZ(0,"ul"),t.YNc(1,Jt,3,1,"li",2),t.YNc(2,It,2,1,"ng-container",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.ticketState.step>0),t.xp6(1),t.Q6J("ngForOf",e.categories)}}let Ot=(()=>{class i{ticketDynamicFormService;onClose=new t.vpe;ticketState;subscriptions=[];get company(){return this.ticketDynamicFormService.company}get categories(){return this.ticketDynamicFormService.formCategories.value}constructor(e){this.ticketDynamicFormService=e}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe(e=>{this.ticketState=e}))}handleChangeStep(e,n){this.ticketDynamicFormService.setStep(e,n)}static \u0275fac=function(n){return new(n||i)(t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form-header"]],outputs:{onClose:"onClose"},decls:4,vars:1,consts:[["aria-label","breadcrumbs",1,"breadcrumb"],[4,"ngIf"],[3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"],[3,"ngClass","click",4,"ngIf"],[3,"ngClass","click"]],template:function(n,o){1&n&&(t.TgZ(0,"h1"),t._uU(1,"Novo Ticket"),t.qZA(),t.TgZ(2,"nav",0),t.YNc(3,Mt,3,2,"ul",1),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngIf",o.company))},dependencies:[l.mk,l.sg,l.O5],encapsulation:2})}return i})();function At(i,c){if(1&i&&(t.ynx(0),t._UZ(1,"rca-ticket-dynamic-form-category",8),t.BQk()),2&i){const e=c.index,n=t.oxw(3);t.xp6(1),t.Q6J("hidden",1!=n.ticketState.step||n.ticketState.stepCategory!=e)}}function Qt(i,c){if(1&i&&(t.ynx(0),t.YNc(1,At,2,1,"ng-container",7),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",null==e.formCategories?null:e.formCategories.controls)}}function Yt(i,c){1&i&&(t.ynx(0),t.TgZ(1,"div",5),t._UZ(2,"rca-ticket-dynamic-form-buttons",9),t.qZA(),t.TgZ(3,"div",5),t._UZ(4,"rca-edit-text",10)(5,"rca-textarea",11),t.qZA(),t.BQk()),2&i&&(t.xp6(5),t.Q6J("minHeight",200))}function qt(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleSubmit())}),t.TgZ(1,"span",13),t._UZ(2,"ion-icon",14),t.qZA()()}}function Ht(i,c){if(1&i&&(t.TgZ(0,"form",1),t._UZ(1,"rca-ticket-dynamic-form-company"),t.YNc(2,Qt,2,1,"ng-container",2),t.YNc(3,Yt,6,1,"ng-container",2),t.ynx(4),t.TgZ(5,"div",3)(6,"div",4)(7,"div",5),t.YNc(8,qt,3,0,"button",6),t.qZA()()(),t.BQk(),t.qZA()),2&i){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(2),t.Q6J("ngIf",e.formCategories),t.xp6(1),t.Q6J("ngIf",2==e.ticketState.step),t.xp6(5),t.Q6J("ngIf",2==e.ticketState.step)}}let Ut=(()=>{class i extends b.y{ticketDynamicFormService;ticketState;get form(){return this.ticketDynamicFormService.form}get formCategories(){return this.ticketDynamicFormService.formCategories}constructor(e,n){super(e),this.ticketDynamicFormService=n}ngOnInit(){this.subscriptions.push(this.ticketDynamicFormService.state.subscribe({next:e=>{this.ticketState=e}})),this.pageService.setInitialized()}handleSubmit(){this.ticketDynamicFormService.save().subscribe(e=>{this.navigateToBrowse()})}navigateToBrowse=()=>{this.form.reset(),this.router.navigate([".."],{relativeTo:this.route})};static \u0275fac=function(n){return new(n||i)(t.Y36(t.zs3),t.Y36(u))};static \u0275cmp=t.Xpm({type:i,selectors:[["rca-ticket-dynamic-form"]],features:[t._Bn([d.Z,u,y.H]),t.qOj],decls:2,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[4,"ngIf"],[1,"row","align-center","justify-center","mt-4"],[1,"col-1"],[1,"row"],["class","col-6 button is-small is-info",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"hidden"],[1,"col-12","m-3"],["label","Assunto","formControlName","title",1,"col-12"],["label","Descri\xe7\xe3o","formControlName","description",1,"col-12",3,"minHeight"],[1,"col-6","button","is-small","is-info",3,"click"],[1,"icon","is-medium"],["name","save"]],template:function(n,o){1&n&&(t._UZ(0,"rca-ticket-dynamic-form-header"),t.YNc(1,Ht,9,4,"form",0)),2&n&&(t.xp6(1),t.Q6J("ngIf",o.form))},dependencies:[l.sg,l.O5,k.V,x,a._Y,a.JJ,a.JL,a.sg,a.u,xt,Dt,Z,Ot],encapsulation:2})}return i})();var Bt=r(5583);const Et=[{path:"",component:ht,pathMatch:"full"},{path:"dynamic",component:Ut,pathMatch:"full"},{path:"new",component:g,pathMatch:"full"},{path:":id/view",component:g,pathMatch:"full"},{path:":id/edit",component:g,pathMatch:"full"},{path:":id/delete",component:g,pathMatch:"full"}];let Gt=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=t.oAB({type:i});static \u0275inj=t.cJS({imports:[a.u5,a.UX,Bt.D,p.Bz.forChild(Et),p.Bz]})}return i})(),Lt=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=t.oAB({type:i});static \u0275inj=t.cJS({imports:[l.ez,O.m,Gt]})}return i})()}}]);